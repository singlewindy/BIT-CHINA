(function () {
    var a = this,
        d = a._,
        b = {}, c = Array.prototype,
        f = Object.prototype,
        k = c.push,
        h = c.slice,
        m = c.concat,
        l = f.toString,
        u = f.hasOwnProperty,
        y = c.forEach,
        s = c.map,
        i = c.reduce,
        j = c.reduceRight,
        n = c.filter,
        g = c.every,
        t = c.some,
        C = c.indexOf,
        x = c.lastIndexOf,
        f = Array.isArray,
        F = Object.keys,
        G = Function.prototype.bind,
        e = function (a) {
            if (a instanceof e) return a;
            if (!(this instanceof e)) return new e(a);
            this._wrapped = a
        };
    if ("undefined" !== typeof exports) {
        if ("undefined" !== typeof module && module.exports) exports = module.exports = e;
        exports._ =
            e
    } else a._ = e;
    e.VERSION = "1.4.2";
    var p = e.each = e.forEach = function (a, c, f) {
        if (null != a)
            if (y && a.forEach === y) a.forEach(c, f);
            else if (a.length === +a.length)
            for (var j = 0, d = a.length; j < d && !(c.call(f, a[j], j, a) === b); j++);
        else
            for (j in a)
                if (e.has(a, j) && c.call(f, a[j], j, a) === b) break
    };
    e.map = e.collect = function (a, b, c) {
        var f = [];
        if (null == a) return f;
        if (s && a.map === s) return a.map(b, c);
        p(a, function (a, o, j) {
            f[f.length] = b.call(c, a, o, j)
        });
        return f
    };
    e.reduce = e.foldl = e.inject = function (a, b, c, f) {
        var j = 2 < arguments.length;
        null == a && (a = []);
        if (i && a.reduce === i) return f && (b = e.bind(b, f)), j ? a.reduce(b, c) : a.reduce(b);
        p(a, function (a, o, d) {
            j ? c = b.call(f, c, a, o, d) : (c = a, j = !0)
        });
        if (!j) throw new TypeError("Reduce of empty array with no initial value");
        return c
    };
    e.reduceRight = e.foldr = function (a, b, c, f) {
        var d = 2 < arguments.length;
        null == a && (a = []);
        if (j && a.reduceRight === j) return f && (b = e.bind(b, f)), 2 < arguments.length ? a.reduceRight(b, c) : a.reduceRight(b);
        var g = a.length;
        if (g !== +g) var n = e.keys(a),
        g = n.length;
        p(a, function (j, e, k) {
            e = n ? n[--g] : --g;
            d ? c = b.call(f,
                c, a[e], e, k) : (c = a[e], d = !0)
        });
        if (!d) throw new TypeError("Reduce of empty array with no initial value");
        return c
    };
    e.find = e.detect = function (a, b, c) {
        var f;
        z(a, function (a, o, j) {
            if (b.call(c, a, o, j)) return f = a, !0
        });
        return f
    };
    e.filter = e.select = function (a, b, c) {
        var f = [];
        if (null == a) return f;
        if (n && a.filter === n) return a.filter(b, c);
        p(a, function (a, o, j) {
            b.call(c, a, o, j) && (f[f.length] = a)
        });
        return f
    };
    e.reject = function (a, b, c) {
        var f = [];
        if (null == a) return f;
        p(a, function (a, o, j) {
            b.call(c, a, o, j) || (f[f.length] = a)
        });
        return f
    };
    e.every = e.all = function (a, c, f) {
        c || (c = e.identity);
        var j = !0;
        if (null == a) return j;
        if (g && a.every === g) return a.every(c, f);
        p(a, function (a, o, d) {
            if (!(j = j && c.call(f, a, o, d))) return b
        });
        return !!j
    };
    var z = e.some = e.any = function (a, c, f) {
        c || (c = e.identity);
        var j = !1;
        if (null == a) return j;
        if (t && a.some === t) return a.some(c, f);
        p(a, function (a, o, d) {
            if (j || (j = c.call(f, a, o, d))) return b
        });
        return !!j
    };
    e.contains = e.include = function (a, b) {
        var c = !1;
        if (null == a) return c;
        return C && a.indexOf === C ? -1 != a.indexOf(b) : c = z(a, function (a) {
            return a ===
                b
        })
    };
    e.invoke = function (a, b) {
        var c = h.call(arguments, 2);
        return e.map(a, function (a) {
            return (e.isFunction(b) ? b : a[b]).apply(a, c)
        })
    };
    e.pluck = function (a, b) {
        return e.map(a, function (a) {
            return a[b]
        })
    };
    e.where = function (a, b) {
        return e.isEmpty(b) ? [] : e.filter(a, function (a) {
            for (var c in b)
                if (b[c] !== a[c]) return !1;
            return !0
        })
    };
    e.max = function (a, b, c) {
        if (!b && e.isArray(a) && a[0] === +a[0] && 65535 > a.length) return Math.max.apply(Math, a);
        if (!b && e.isEmpty(a)) return -Infinity;
        var f = {
            computed: -Infinity
        };
        p(a, function (a, o, j) {
            o = b ? b.call(c,
                a, o, j) : a;
            o >= f.computed && (f = {
                value: a,
                computed: o
            })
        });
        return f.value
    };
    e.min = function (a, b, c) {
        if (!b && e.isArray(a) && a[0] === +a[0] && 65535 > a.length) return Math.min.apply(Math, a);
        if (!b && e.isEmpty(a)) return Infinity;
        var f = {
            computed: Infinity
        };
        p(a, function (a, o, j) {
            o = b ? b.call(c, a, o, j) : a;
            o < f.computed && (f = {
                value: a,
                computed: o
            })
        });
        return f.value
    };
    e.shuffle = function (a) {
        var b, c = 0,
            f = [];
        p(a, function (a) {
            b = e.random(c++);
            f[c - 1] = f[b];
            f[b] = a
        });
        return f
    };
    var w = function (a) {
        return e.isFunction(a) ? a : function (b) {
            return b[a]
        }
    };
    e.sortBy =
        function (a, b, c) {
            var f = w(b);
            return e.pluck(e.map(a, function (a, b, o) {
                return {
                    value: a,
                    index: b,
                    criteria: f.call(c, a, b, o)
                }
            }).sort(function (a, b) {
                var c = a.criteria,
                    f = b.criteria;
                if (c !== f) {
                    if (c > f || void 0 === c) return 1;
                    if (c < f || void 0 === f) return -1
                }
                return a.index < b.index ? -1 : 1
            }), "value")
    };
    var v = function (a, b, c, f) {
        var j = {}, d = w(b);
        p(a, function (b, e) {
            var g = d.call(c, b, e, a);
            f(j, g, b)
        });
        return j
    };
    e.groupBy = function (a, b, c) {
        return v(a, b, c, function (a, b, c) {
            (e.has(a, b) ? a[b] : a[b] = []).push(c)
        })
    };
    e.countBy = function (a, b, c) {
        return v(a,
            b, c, function (a, b) {
                e.has(a, b) || (a[b] = 0);
                a[b]++
            })
    };
    e.sortedIndex = function (a, b, c, f) {
        for (var c = null == c ? e.identity : w(c), b = c.call(f, b), j = 0, d = a.length; j < d;) {
            var g = j + d >>> 1;
            c.call(f, a[g]) < b ? j = g + 1 : d = g
        }
        return j
    };
    e.toArray = function (a) {
        return !a ? [] : a.length === +a.length ? h.call(a) : e.values(a)
    };
    e.size = function (a) {
        return a.length === +a.length ? a.length : e.keys(a).length
    };
    e.first = e.head = e.take = function (a, b, c) {
        return null != b && !c ? h.call(a, 0, b) : a[0]
    };
    e.initial = function (a, b, c) {
        return h.call(a, 0, a.length - (null == b || c ? 1 : b))
    };
    e.last = function (a, b, c) {
        return null != b && !c ? h.call(a, Math.max(a.length - b, 0)) : a[a.length - 1]
    };
    e.rest = e.tail = e.drop = function (a, b, c) {
        return h.call(a, null == b || c ? 1 : b)
    };
    e.compact = function (a) {
        return e.filter(a, function (a) {
            return !!a
        })
    };
    var q = function (a, b, c) {
        p(a, function (a) {
            e.isArray(a) ? b ? k.apply(c, a) : q(a, b, c) : c.push(a)
        });
        return c
    };
    e.flatten = function (a, b) {
        return q(a, b, [])
    };
    e.without = function (a) {
        return e.difference(a, h.call(arguments, 1))
    };
    e.uniq = e.unique = function (a, b, c, f) {
        var c = c ? e.map(a, c, f) : a,
            j = [],
            d = [];
        p(c,
            function (c, f) {
                if (b ? !f || d[d.length - 1] !== c : !e.contains(d, c)) d.push(c), j.push(a[f])
            });
        return j
    };
    e.union = function () {
        return e.uniq(m.apply(c, arguments))
    };
    e.intersection = function (a) {
        var b = h.call(arguments, 1);
        return e.filter(e.uniq(a), function (a) {
            return e.every(b, function (b) {
                return 0 <= e.indexOf(b, a)
            })
        })
    };
    e.difference = function (a) {
        var b = m.apply(c, h.call(arguments, 1));
        return e.filter(a, function (a) {
            return !e.contains(b, a)
        })
    };
    e.zip = function () {
        for (var a = h.call(arguments), b = e.max(e.pluck(a, "length")), c = Array(b),
                f = 0; f < b; f++) c[f] = e.pluck(a, "" + f);
        return c
    };
    e.object = function (a, b) {
        for (var c = {}, f = 0, j = a.length; f < j; f++) b ? c[a[f]] = b[f] : c[a[f][0]] = a[f][1];
        return c
    };
    e.indexOf = function (a, b, c) {
        if (null == a) return -1;
        var f = 0,
            j = a.length;
        if (c)
            if ("number" == typeof c) f = 0 > c ? Math.max(0, j + c) : c;
            else return f = e.sortedIndex(a, b), a[f] === b ? f : -1;
        if (C && a.indexOf === C) return a.indexOf(b, c);
        for (; f < j; f++)
            if (a[f] === b) return f;
        return -1
    };
    e.lastIndexOf = function (a, b, c) {
        if (null == a) return -1;
        var f = null != c;
        if (x && a.lastIndexOf === x) return f ? a.lastIndexOf(b,
            c) : a.lastIndexOf(b);
        for (c = f ? c : a.length; c--;)
            if (a[c] === b) return c;
        return -1
    };
    e.range = function (a, b, c) {
        1 >= arguments.length && (b = a || 0, a = 0);
        for (var c = arguments[2] || 1, f = Math.max(Math.ceil((b - a) / c), 0), j = 0, d = Array(f); j < f;) d[j++] = a, a += c;
        return d
    };
    var r = function () {};
    e.bind = function (a, b) {
        var c, f;
        if (a.bind === G && G) return G.apply(a, h.call(arguments, 1));
        if (!e.isFunction(a)) throw new TypeError;
        f = h.call(arguments, 2);
        return c = function () {
            if (!(this instanceof c)) return a.apply(b, f.concat(h.call(arguments)));
            r.prototype =
                a.prototype;
            var j = new r,
                d = a.apply(j, f.concat(h.call(arguments)));
            return Object(d) === d ? d : j
        }
    };
    e.bindAll = function (a) {
        var b = h.call(arguments, 1);
        0 == b.length && (b = e.functions(a));
        p(b, function (b) {
            a[b] = e.bind(a[b], a)
        });
        return a
    };
    e.memoize = function (a, b) {
        var c = {};
        b || (b = e.identity);
        return function () {
            var f = b.apply(this, arguments);
            return e.has(c, f) ? c[f] : c[f] = a.apply(this, arguments)
        }
    };
    e.delay = function (a, b) {
        var c = h.call(arguments, 2);
        return setTimeout(function () {
            return a.apply(null, c)
        }, b)
    };
    e.defer = function (a) {
        return e.delay.apply(e, [a, 1].concat(h.call(arguments, 1)))
    };
    e.throttle = function (a, b) {
        var c, f, j, d, g, n, k = e.debounce(function () {
                g = d = !1
            }, b);
        return function () {
            c = this;
            f = arguments;
            var e;
            j || (j = setTimeout(function () {
                j = null;
                g && (n = a.apply(c, f));
                k()
            }, b));
            d ? g = !0 : (d = !0, n = a.apply(c, f));
            k();
            return n
        }
    };
    e.debounce = function (a, b, c) {
        var f, j;
        return function () {
            var d = this,
                e = arguments,
                g = c && !f;
            clearTimeout(f);
            f = setTimeout(function () {
                f = null;
                c || (j = a.apply(d, e))
            }, b);
            g && (j = a.apply(d, e));
            return j
        }
    };
    e.once = function (a) {
        var b = !1,
            c;
        return function () {
            if (b) return c;
            b = !0;
            c = a.apply(this, arguments);
            a = null;
            return c
        }
    };
    e.wrap = function (a, b) {
        return function () {
            var c = [a];
            k.apply(c, arguments);
            return b.apply(this, c)
        }
    };
    e.compose = function () {
        var a = arguments;
        return function () {
            for (var b = arguments, c = a.length - 1; 0 <= c; c--) b = [a[c].apply(this, b)];
            return b[0]
        }
    };
    e.after = function (a, b) {
        return 0 >= a ? b() : function () {
            if (1 > --a) return b.apply(this, arguments)
        }
    };
    e.keys = F || function (a) {
        if (a !== Object(a)) throw new TypeError("Invalid object");
        var b = [],
            c;
        for (c in a) e.has(a, c) && (b[b.length] = c);
        return b
    };
    e.values = function (a) {
        var b = [],
            c;
        for (c in a) e.has(a, c) && b.push(a[c]);
        return b
    };
    e.pairs = function (a) {
        var b = [],
            c;
        for (c in a) e.has(a, c) && b.push([c, a[c]]);
        return b
    };
    e.invert = function (a) {
        var b = {}, c;
        for (c in a) e.has(a, c) && (b[a[c]] = c);
        return b
    };
    e.functions = e.methods = function (a) {
        var b = [],
            c;
        for (c in a) e.isFunction(a[c]) && b.push(c);
        return b.sort()
    };
    e.extend = function (a) {
        p(h.call(arguments, 1), function (b) {
            for (var c in b) a[c] = b[c]
        });
        return a
    };
    e.pick = function (a) {
        var b = {}, f = m.apply(c, h.call(arguments, 1));
        p(f, function (c) {
            c in
                a && (b[c] = a[c])
        });
        return b
    };
    e.omit = function (a) {
        var b = {}, f = m.apply(c, h.call(arguments, 1)),
            j;
        for (j in a) e.contains(f, j) || (b[j] = a[j]);
        return b
    };
    e.defaults = function (a) {
        p(h.call(arguments, 1), function (b) {
            for (var c in b) null == a[c] && (a[c] = b[c])
        });
        return a
    };
    e.clone = function (a) {
        return !e.isObject(a) ? a : e.isArray(a) ? a.slice() : e.extend({}, a)
    };
    e.tap = function (a, b) {
        b(a);
        return a
    };
    var A = function (a, b, c, f) {
        if (a === b) return 0 !== a || 1 / a == 1 / b;
        if (null == a || null == b) return a === b;
        if (a instanceof e) a = a._wrapped;
        if (b instanceof e) b =
            b._wrapped;
        var j = l.call(a);
        if (j != l.call(b)) return !1;
        switch (j) {
        case "[object String]":
            return a == "" + b;
        case "[object Number]":
            return a != +a ? b != +b : 0 == a ? 1 / a == 1 / b : a == +b;
        case "[object Date]":
        case "[object Boolean]":
            return +a == +b;
        case "[object RegExp]":
            return a.source == b.source && a.global == b.global && a.multiline == b.multiline && a.ignoreCase == b.ignoreCase
        }
        if ("object" != typeof a || "object" != typeof b) return !1;
        for (var d = c.length; d--;)
            if (c[d] == a) return f[d] == b;
        c.push(a);
        f.push(b);
        var d = 0,
            g = !0;
        if ("[object Array]" == j) {
            if (d =
                a.length, g = d == b.length)
                for (; d-- && (g = A(a[d], b[d], c, f)););
        } else {
            var j = a.constructor,
                n = b.constructor;
            if (j !== n && (!e.isFunction(j) || !(j instanceof j && e.isFunction(n) && n instanceof n))) return !1;
            for (var k in a)
                if (e.has(a, k) && (d++, !(g = e.has(b, k) && A(a[k], b[k], c, f)))) break;
            if (g) {
                for (k in b)
                    if (e.has(b, k) && !d--) break;
                g = !d
            }
        }
        c.pop();
        f.pop();
        return g
    };
    e.isEqual = function (a, b) {
        return A(a, b, [], [])
    };
    e.isEmpty = function (a) {
        if (null == a) return !0;
        if (e.isArray(a) || e.isString(a)) return 0 === a.length;
        for (var b in a)
            if (e.has(a,
                b)) return !1;
        return !0
    };
    e.isElement = function (a) {
        return !!(a && 1 === a.nodeType)
    };
    e.isArray = f || function (a) {
        return "[object Array]" == l.call(a)
    };
    e.isObject = function (a) {
        return a === Object(a)
    };
    p("Arguments,Function,String,Number,Date,RegExp".split(","), function (a) {
        e["is" + a] = function (b) {
            return l.call(b) == "[object " + a + "]"
        }
    });
    if (!e.isArguments(arguments)) e.isArguments = function (a) {
        return !(!a || !e.has(a, "callee"))
    };
    if ("function" !== typeof / . / ) e.isFunction = function (a) {
        return "function" === typeof a
    };
    e.isFinite = function (a) {
        return e.isNumber(a) &&
            isFinite(a)
    };
    e.isNaN = function (a) {
        return e.isNumber(a) && a != +a
    };
    e.isBoolean = function (a) {
        return !0 === a || !1 === a || "[object Boolean]" == l.call(a)
    };
    e.isNull = function (a) {
        return null === a
    };
    e.isUndefined = function (a) {
        return void 0 === a
    };
    e.has = function (a, b) {
        return u.call(a, b)
    };
    e.noConflict = function () {
        a._ = d;
        return this
    };
    e.identity = function (a) {
        return a
    };
    e.times = function (a, b, c) {
        for (var f = 0; f < a; f++) b.call(c, f)
    };
    e.random = function (a, b) {
        null == b && (b = a, a = 0);
        return a + (0 | Math.random() * (b - a + 1))
    };
    var B = {
        escape: {
            "&": "&amp;",
            "<": "&lt;",
            ">": "&gt;",
            '"': "&quot;",
            "'": "&#x27;",
            "/": "&#x2F;"
        }
    };
    B.unescape = e.invert(B.escape);
    var H = {
        escape: RegExp("[" + e.keys(B.escape).join("") + "]", "g"),
        unescape: RegExp("(" + e.keys(B.unescape).join("|") + ")", "g")
    };
    e.each(["escape", "unescape"], function (a) {
        e[a] = function (b) {
            return null == b ? "" : ("" + b).replace(H[a], function (b) {
                return B[a][b]
            })
        }
    });
    e.result = function (a, b) {
        if (null == a) return null;
        var c = a[b];
        return e.isFunction(c) ? c.call(a) : c
    };
    e.mixin = function (a) {
        p(e.functions(a), function (b) {
            var c = e[b] = a[b];
            e.prototype[b] =
                function () {
                    var a = [this._wrapped];
                    k.apply(a, arguments);
                    a = c.apply(e, a);
                    return this._chain ? e(a).chain() : a
            }
        })
    };
    var I = 0;
    e.uniqueId = function (a) {
        var b = I++;
        return a ? a + b : b
    };
    e.templateSettings = {
        evaluate: /<%([\s\S]+?)%>/g,
        interpolate: /<%=([\s\S]+?)%>/g,
        escape: /<%-([\s\S]+?)%>/g
    };
    var D = /(.)^/,
        E = {
            "'": "'",
            "\\": "\\",
            "\r": "r",
            "\n": "n",
            "\t": "t",
            "\u2028": "u2028",
            "\u2029": "u2029"
        }, J = /\\|'|\r|\n|\t|\u2028|\u2029/g;
    e.template = function (a, b, c) {
        var c = e.defaults({}, c, e.templateSettings),
            f = RegExp([(c.escape || D).source, (c.interpolate ||
                D).source, (c.evaluate || D).source].join("|") + "|$", "g"),
            j = 0,
            d = "__p+='";
        a.replace(f, function (b, c, f, e, g) {
            d += a.slice(j, g).replace(J, function (a) {
                return "\\" + E[a]
            });
            d += c ? "'+\n((__t=(" + c + "))==null?'':_.escape(__t))+\n'" : f ? "'+\n((__t=(" + f + "))==null?'':__t)+\n'" : e ? "';\n" + e + "\n__p+='" : "";
            j = g + b.length
        });
        d += "';\n";
        c.variable || (d = "with(obj||{}){\n" + d + "}\n");
        d = "var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n" + d + "return __p;\n";
        try {
            var g = new Function(c.variable || "obj", "_",
                d)
        } catch (n) {
            throw n.source = d, n;
        }
        if (b) return g(b, e);
        b = function (a) {
            return g.call(this, a, e)
        };
        b.source = "function(" + (c.variable || "obj") + "){\n" + d + "}";
        return b
    };
    e.chain = function (a) {
        return e(a).chain()
    };
    e.mixin(e);
    p("pop,push,reverse,shift,sort,splice,unshift".split(","), function (a) {
        var b = c[a];
        e.prototype[a] = function () {
            var c = this._wrapped;
            b.apply(c, arguments);
            ("shift" == a || "splice" == a) && 0 === c.length && delete c[0];
            return this._chain ? e(c).chain() : c
        }
    });
    p(["concat", "join", "slice"], function (a) {
        var b = c[a];
        e.prototype[a] =
            function () {
                var a = b.apply(this._wrapped, arguments);
                return this._chain ? e(a).chain() : a
        }
    });
    e.extend(e.prototype, {
        chain: function () {
            this._chain = !0;
            return this
        },
        value: function () {
            return this._wrapped
        }
    })
}).call(this);
(function (a, d) {
    var b = d.prototype.trim,
        c = d.prototype.trimRight,
        f = d.prototype.trimLeft,
        k = function (a, b) {
            if (1 > b) return "";
            for (var c = ""; 0 < b;) b & 1 && (c += a), b >>= 1, a += a;
            return c
        }, h = [].slice,
        m = function (a) {
            return null == a ? "\\s" : a.source ? a.source : "[" + i.escapeRegExp(a) + "]"
        }, l = {
            lt: "<",
            gt: ">",
            quot: '"',
            apos: "'",
            amp: "&"
        }, u = {}, y;
    for (y in l) u[l[y]] = y;
    var s = function () {
        function a(b) {
            return Object.prototype.toString.call(b).slice(8, -1).toLowerCase()
        }
        var b = function () {
            b.cache.hasOwnProperty(arguments[0]) || (b.cache[arguments[0]] =
                b.parse(arguments[0]));
            return b.format.call(null, b.cache[arguments[0]], arguments)
        };
        b.format = function (b, c) {
            var f = 1,
                n = b.length,
                h = "",
                i = [],
                e, m, l, u;
            for (e = 0; e < n; e++)
                if (h = a(b[e]), "string" === h) i.push(b[e]);
                else if ("array" === h) {
                l = b[e];
                if (l[2]) {
                    h = c[f];
                    for (m = 0; m < l[2].length; m++) {
                        if (!h.hasOwnProperty(l[2][m])) throw Error(s('[_.sprintf] property "%s" does not exist', l[2][m]));
                        h = h[l[2][m]]
                    }
                } else h = l[1] ? c[l[1]] : c[f++]; if (/[^s]/.test(l[8]) && "number" != a(h)) throw Error(s("[_.sprintf] expecting number but found %s",
                    a(h)));
                switch (l[8]) {
                case "b":
                    h = h.toString(2);
                    break;
                case "c":
                    h = d.fromCharCode(h);
                    break;
                case "d":
                    h = parseInt(h, 10);
                    break;
                case "e":
                    h = l[7] ? h.toExponential(l[7]) : h.toExponential();
                    break;
                case "f":
                    h = l[7] ? parseFloat(h).toFixed(l[7]) : parseFloat(h);
                    break;
                case "o":
                    h = h.toString(8);
                    break;
                case "s":
                    h = (h = d(h)) && l[7] ? h.substring(0, l[7]) : h;
                    break;
                case "u":
                    h = Math.abs(h);
                    break;
                case "x":
                    h = h.toString(16);
                    break;
                case "X":
                    h = h.toString(16).toUpperCase()
                }
                h = /[def]/.test(l[8]) && l[3] && 0 <= h ? "+" + h : h;
                m = l[4] ? "0" == l[4] ? "0" : l[4].charAt(1) :
                    " ";
                u = l[6] - d(h).length;
                m = l[6] ? k(m, u) : "";
                i.push(l[5] ? h + m : m + h)
            }
            return i.join("")
        };
        b.cache = {};
        b.parse = function (a) {
            for (var b = [], c = [], f = 0; a;) {
                if (null !== (b = /^[^\x25]+/.exec(a))) c.push(b[0]);
                else if (null !== (b = /^\x25{2}/.exec(a))) c.push("%");
                else if (null !== (b = /^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(a))) {
                    if (b[2]) {
                        var f = f | 1,
                            j = [],
                            d = b[2],
                            e = [];
                        if (null !== (e = /^([a-z_][a-z_\d]*)/i.exec(d)))
                            for (j.push(e[1]);
                                "" !== (d = d.substring(e[0].length));)
                                if (null !== (e = /^\.([a-z_][a-z_\d]*)/i.exec(d))) j.push(e[1]);
                                else if (null !== (e = /^\[(\d+)\]/.exec(d))) j.push(e[1]);
                        else throw Error("[_.sprintf] huh?");
                        else throw Error("[_.sprintf] huh?");
                        b[2] = j
                    } else f |= 2; if (3 === f) throw Error("[_.sprintf] mixing positional and named placeholders is not (yet) supported");
                    c.push(b)
                } else throw Error("[_.sprintf] huh?");
                a = a.substring(b[0].length)
            }
            return c
        };
        return b
    }(),
        i = {
            VERSION: "2.3.0",
            isBlank: function (a) {
                null == a && (a = "");
                return /^\s*$/.test(a)
            },
            stripTags: function (a) {
                return null == a ? "" : d(a).replace(/<\/?[^>]+>/g, "")
            },
            capitalize: function (a) {
                a =
                    null == a ? "" : d(a);
                return a.charAt(0).toUpperCase() + a.slice(1)
            },
            chop: function (a, b) {
                if (null == a) return [];
                a = d(a);
                b = ~~b;
                return 0 < b ? a.match(RegExp(".{1," + b + "}", "g")) : [a]
            },
            clean: function (a) {
                return i.strip(a).replace(/\s+/g, " ")
            },
            count: function (a, b) {
                return null == a || null == b ? 0 : d(a).split(b).length - 1
            },
            chars: function (a) {
                return null == a ? [] : d(a).split("")
            },
            swapCase: function (a) {
                return null == a ? "" : d(a).replace(/\S/g, function (a) {
                    return a === a.toUpperCase() ? a.toLowerCase() : a.toUpperCase()
                })
            },
            escapeHTML: function (a) {
                return null ==
                    a ? "" : d(a).replace(/[&<>"']/g, function (a) {
                        return "&" + u[a] + ";"
                    })
            },
            unescapeHTML: function (a) {
                return null == a ? "" : d(a).replace(/\&([^;]+);/g, function (a, b) {
                    var c;
                    return b in l ? l[b] : (c = b.match(/^#x([\da-fA-F]+)$/)) ? d.fromCharCode(parseInt(c[1], 16)) : (c = b.match(/^#(\d+)$/)) ? d.fromCharCode(~~c[1]) : a
                })
            },
            escapeRegExp: function (a) {
                return null == a ? "" : d(a).replace(/([.*+?^=!:${}()|[\]\/\\])/g, "\\$1")
            },
            splice: function (a, b, c, f) {
                a = i.chars(a);
                a.splice(~~b, ~~c, f);
                return a.join("")
            },
            insert: function (a, b, c) {
                return i.splice(a,
                    b, 0, c)
            },
            include: function (a, b) {
                return "" === b ? !0 : null == a ? !1 : -1 !== d(a).indexOf(b)
            },
            join: function () {
                var a = h.call(arguments),
                    b = a.shift();
                null == b && (b = "");
                return a.join(b)
            },
            lines: function (a) {
                return null == a ? [] : d(a).split("\n")
            },
            reverse: function (a) {
                return i.chars(a).reverse().join("")
            },
            startsWith: function (a, b) {
                if ("" === b) return !0;
                if (null == a || null == b) return !1;
                a = d(a);
                b = d(b);
                return a.length >= b.length && a.slice(0, b.length) === b
            },
            endsWith: function (a, b) {
                if ("" === b) return !0;
                if (null == a || null == b) return !1;
                a = d(a);
                b = d(b);
                return a.length >= b.length && a.slice(a.length - b.length) === b
            },
            succ: function (a) {
                if (null == a) return "";
                a = d(a);
                return a.slice(0, -1) + d.fromCharCode(a.charCodeAt(a.length - 1) + 1)
            },
            titleize: function (a) {
                return null == a ? "" : d(a).replace(/(?:^|\s)\S/g, function (a) {
                    return a.toUpperCase()
                })
            },
            camelize: function (a) {
                return i.trim(a).replace(/[-_\s]+(.)?/g, function (a, b) {
                    return b.toUpperCase()
                })
            },
            underscored: function (a) {
                return i.trim(a).replace(/([a-z\d])([A-Z]+)/g, "$1_$2").replace(/[-\s]+/g, "_").toLowerCase()
            },
            dasherize: function (a) {
                return i.trim(a).replace(/([A-Z])/g,
                    "-$1").replace(/[-_\s]+/g, "-").toLowerCase()
            },
            classify: function (a) {
                return i.titleize(d(a).replace(/_/g, " ")).replace(/\s/g, "")
            },
            humanize: function (a) {
                return i.capitalize(i.underscored(a).replace(/_id$/, "").replace(/_/g, " "))
            },
            trim: function (a, c) {
                if (null == a) return "";
                if (!c && b) return b.call(a);
                c = m(c);
                return d(a).replace(RegExp("^" + c + "+|" + c + "+$", "g"), "")
            },
            ltrim: function (a, b) {
                if (null == a) return "";
                if (!b && f) return f.call(a);
                b = m(b);
                return d(a).replace(RegExp("^" + b + "+"), "")
            },
            rtrim: function (a, b) {
                if (null == a) return "";
                if (!b && c) return c.call(a);
                b = m(b);
                return d(a).replace(RegExp(b + "+$"), "")
            },
            truncate: function (a, b, c) {
                if (null == a) return "";
                a = d(a);
                b = ~~b;
                return a.length > b ? a.slice(0, b) + (c || "...") : a
            },
            prune: function (a, b, c) {
                if (null == a) return "";
                a = d(a);
                b = ~~b;
                c = null != c ? d(c) : "...";
                if (a.length <= b) return a;
                b = a.slice(0, b + 1).replace(/.(?=\W*\w*$)/g, function (a) {
                    return a.toUpperCase() !== a.toLowerCase() ? "A" : " "
                });
                b = b.slice(b.length - 2).match(/\w\w/) ? b.replace(/\s*\S+$/, "") : i.rtrim(b.slice(0, b.length - 1));
                return (b + c).length > a.length ? a :
                    a.slice(0, b.length) + c
            },
            words: function (a, b) {
                return i.isBlank(a) ? [] : i.trim(a, b).split(b || /\s+/)
            },
            pad: function (a, b, c, f) {
                var a = null == a ? "" : d(a),
                    b = ~~b,
                    h = 0;
                c ? 1 < c.length && (c = c.charAt(0)) : c = " ";
                switch (f) {
                case "right":
                    return h = b - a.length, a + k(c, h);
                case "both":
                    return h = b - a.length, k(c, Math.ceil(h / 2)) + a + k(c, Math.floor(h / 2));
                default:
                    return h = b - a.length, k(c, h) + a
                }
            },
            lpad: function (a, b, c) {
                return i.pad(a, b, c)
            },
            rpad: function (a, b, c) {
                return i.pad(a, b, c, "right")
            },
            lrpad: function (a, b, c) {
                return i.pad(a, b, c, "both")
            },
            sprintf: s,
            vsprintf: function (a, b) {
                b.unshift(a);
                return s.apply(null, b)
            },
            toNumber: function (a, b) {
                if (null == a || "" == a) return 0;
                var a = d(a),
                    c;
                c = 1 * (1 * a || 0).toFixed(~~b) || 0;
                return 0 === c && !a.match(/^0+$/) ? Number.NaN : c
            },
            numberFormat: function (a, b, c, f) {
                if (isNaN(a) || null == a) return "";
                a = a.toFixed(~~b);
                f = f || ",";
                a = a.split(".");
                c = a[1] ? (c || ".") + a[1] : "";
                return a[0].replace(/(\d)(?=(?:\d{3})+$)/g, "$1" + f) + c
            },
            strRight: function (a, b) {
                if (null == a) return "";
                var a = d(a),
                    b = null != b ? d(b) : b,
                    c = !b ? -1 : a.indexOf(b);
                return~ c ? a.slice(c + b.length, a.length) :
                    a
            },
            strRightBack: function (a, b) {
                if (null == a) return "";
                var a = d(a),
                    b = null != b ? d(b) : b,
                    c = !b ? -1 : a.lastIndexOf(b);
                return~ c ? a.slice(c + b.length, a.length) : a
            },
            strLeft: function (a, b) {
                if (null == a) return "";
                var a = d(a),
                    b = null != b ? d(b) : b,
                    c = !b ? -1 : a.indexOf(b);
                return~ c ? a.slice(0, c) : a
            },
            strLeftBack: function (a, b) {
                if (null == a) return "";
                var a = a + "",
                    c = a.lastIndexOf(null != b ? "" + b : b);
                return~ c ? a.slice(0, c) : a
            },
            toSentence: function (a, b, c, f) {
                var b = b || ", ",
                    c = c || " and ",
                    d = a.slice(),
                    h = d.pop();
                2 < a.length && f && (c = i.rtrim(b) + c);
                return d.length ? d.join(b) +
                    c + h : h
            },
            toSentenceSerial: function () {
                var a = h.call(arguments);
                a[3] = !0;
                return i.toSentence.apply(i, a)
            },
            slugify: function (a) {
                if (null == a) return "";
                var b = RegExp(m("\u0105\u00e0\u00e1\u00e4\u00e2\u00e3\u00e5\u00e6\u0107\u0119\u00e8\u00e9\u00eb\u00ea\u00ec\u00ed\u00ef\u00ee\u0142\u0144\u00f2\u00f3\u00f6\u00f4\u00f5\u00f8\u00f9\u00fa\u00fc\u00fb\u00f1\u00e7\u017c\u017a"), "g"),
                    a = d(a).toLowerCase().replace(b, function (a) {
                        return "aaaaaaaaceeeeeiiiilnoooooouuuunczz".charAt("\u0105\u00e0\u00e1\u00e4\u00e2\u00e3\u00e5\u00e6\u0107\u0119\u00e8\u00e9\u00eb\u00ea\u00ec\u00ed\u00ef\u00ee\u0142\u0144\u00f2\u00f3\u00f6\u00f4\u00f5\u00f8\u00f9\u00fa\u00fc\u00fb\u00f1\u00e7\u017c\u017a".indexOf(a)) ||
                            "-"
                    });
                return i.dasherize(a.replace(/[^\w\s-]/g, ""))
            },
            surround: function (a, b) {
                return [b, a, b].join("")
            },
            quote: function (a) {
                return i.surround(a, '"')
            },
            exports: function () {
                var a = {}, b;
                for (b in this) this.hasOwnProperty(b) && !b.match(/^(?:include|contains|reverse)$/) && (a[b] = this[b]);
                return a
            },
            repeat: function (a, b, c) {
                if (null == a) return "";
                b = ~~b;
                if (null == c) return k(d(a), b);
                for (var f = []; 0 < b; f[--b] = a);
                return f.join(c)
            },
            levenshtein: function (a, b) {
                if (null == a && null == b) return 0;
                if (null == a) return d(b).length;
                if (null == b) return d(a).length;
                for (var a = d(a), b = d(b), c = [], f, h, k = 0; k <= b.length; k++)
                    for (var i = 0; i <= a.length; i++) h = k && i ? a.charAt(i - 1) === b.charAt(k - 1) ? f : Math.min(c[i], c[i - 1], f) + 1 : k + i, f = c[i], c[i] = h;
                return c.pop()
            }
        };
    i.strip = i.trim;
    i.lstrip = i.ltrim;
    i.rstrip = i.rtrim;
    i.center = i.lrpad;
    i.rjust = i.lpad;
    i.ljust = i.rpad;
    i.contains = i.include;
    i.q = i.quote;
    if ("undefined" !== typeof exports) {
        if ("undefined" !== typeof module && module.exports) module.exports = i;
        exports._s = i
    } else "function" === typeof define && define.amd ? define("underscore.string", [], function () {
        return i
    }) :
        (a._ = a._ || {}, a._.string = a._.str = i)
})(this, String);
_.mixin(_.string.exports());
_.mixin({
    includes: _.str.include,
    inherit: function (a, d) {
        a.prototype = new d;
        a.prototype.constructor = a;
        a.superclass = d.prototype;
        return a
    },
    reject: function (a, d, b) {
        if (_.isNumber(a.length)) {
            var c = [];
            if (null == a) return c;
            _.each(a, function (a, k, h) {
                d.call(b, a, k, h) || (c[c.length] = a)
            })
        } else {
            c = {};
            if (null == a) return c;
            _.each(a, function (a, k, h) {
                d.call(b, a, k, h) || (c[k] = a)
            })
        }
        return c
    },
    group: function (a, d, b) {
        return _.reduce(a, function (a, f) {
            var k = d.call(b, f);
            k in a ? a[k].push(f) : a[k] = [f];
            return a
        }, {}, b)
    },
    bundle: function (a, d,
        b) {
        d = d || function (a, b) {
            return a === b
        };
        return _.reduce(a, function (a, f) {
            var k = a[a.length - 1],
                h = k[0];
            void 0 !== h && null !== h ? d.call(b, h, f) ? k.push(f) : a.push([f]) : k.push(f);
            return a
        }, [
            []
        ])
    },
    uniq2: function (a, d, b) {
        return _.reduce(a, function (a, f, k) {
            if (0 == k || !_.any(a, function (a) {
                if (d.call(b, a, f)) return !0
            })) a[a.length] = f;
            return a
        }, [])
    },
    choice: function (a) {
        var d = Math.floor(Math.random() * a.length);
        return a[d]
    },
    namespace: function (a, d) {
        var d = d || function () {
                return {}
            }, b = a.split("."),
            c = window;
        _.each(b, function (a) {
            void 0 ===
                c[a] && (c[a] = {});
            c = c[a]
        });
        _.extend(c, d(c))
    },
    decode_html: function (a) {
        var d = document.createElement("div");
        d.innerHTML = a;
        return 0 === d.childNodes.length ? "" : d.childNodes[0].nodeValue
    },
    obj_diff: function (a, d) {
        var b = {};
        _.each(a, function (a, f) {
            if (!Object.prototype.hasOwnProperty.call(d, f) || a !== d[f]) b[f] = a
        });
        return b
    }
});
var WidgetCSS = {
    already_inserted: {},
    gradient: function (a, d, b, c) {
        a.background = [];
        void 0 !== c && a.background.push(c);
        a.background = a.background.concat([(c ? c + "," : "") + "-webkit-gradient(linear, left top, left bottom, from(" + d + "), to(" + b + "))", (c ? c + "," : "") + "-moz-linear-gradient(top, " + d + ", " + b + ")"]);
        a.filter = 'progid:DXImageTransform.Microsoft.gradient(startColorstr="' + d + '", endColorstr="' + b + '")';
        return a
    },
    gradient_horizontal: function (a, d, b, c) {
        a.background = [];
        void 0 !== c && a.background.push(c);
        a.background = a.background.concat([(c ?
            c + "," : "") + "-webkit-gradient(linear, left top, right top, from(" + d + "), to(" + b + "))", (c ? c + "," : "") + "-moz-linear-gradient(left, " + d + ", " + b + ")"]);
        a.filter = 'progid:DXImageTransform.Microsoft.gradient(startColorstr="' + d + '", endColorstr="' + b + '", GradientType=1)';
        return a
    },
    xbrowser: function (a, d, b) {
        _.each(["", "-moz-", "-webkit-", "-khtml-", "-o-"], function (c) {
            a[c + d] = b
        })
    },
    custom_button: function (a) {
        _.each({
                cursor: "pointer",
                "line-height": "normal !important",
                border: "0",
                outline: "0",
                "background-color": "transparent"
            },
            function (d, b) {
                b in a || (a[b] = d)
            })
    },
    rounded: function (a, d) {
        for (var b = d.split(" "); 4 > b.length;) b.push("0px");
        _.each(_.zip(["border-top-left-radius", "border-top-right-radius", "border-bottom-right-radius", "border-bottom-left-radius"], b), function (b) {
            WidgetCSS.xbrowser(a, b[0], b[1])
        })
    },
    generate: function (a, d, b) {
        var c = [];
        $("#widget_css").length || $("head").append('<style type="text/css" id="widget_css"></style>');
        b in WidgetCSS.already_inserted || (_.each(a, function (a, b) {
            var h;
            h = b == d.class_name ? "." + b : b.length &&
                "^" == b[0] ? "." + d.class_name + b.slice(1) : "." + d.class_name + " " + b;
            h += " {";
            _.each(a, function (a, b) {
                _.isArray(a) ? _.each(a, function (a) {
                    h += b + ": " + a + ";\n"
                }) : h += b + ": " + a + ";\n"
            });
            h += "}";
            c.push(h)
        }), $("#widget_css").append(c.join("\n")), WidgetCSS.already_inserted[b] = !0)
    }
};

function JSWidget() {
    this.class_name = "js_widget";
    this.defer_style = !1
}
JSWidget.prototype.create = function (a) {
    this.container = a ? $(a) : $("<div>");
    this.container.attr("id") ? this.id = this.container.attr("id") : (this.id = "jswidget_" + Math.floor(1E9 * Math.random()), this.container.attr("id", this.id));
    this.container.addClass(this.class_name);
    this.defer_style || this.style();
    return this
};
JSWidget.prototype.remove = function () {
    this.container.trigger("remove_item", [this]);
    this.container.remove()
};
JSWidget.prototype.val = function () {
    return void 0 !== this.value ? this.value : void 0 !== this.container.attr("val") ? this.container.attr("val") : null
};
JSWidget.prototype.styles = function () {};
JSWidget.prototype.style = function () {
    if (!window.DISABLE_JSWIDGET_STYLES) {
        var a = this.class_name + "_style",
            d = this.styles();
        d && WidgetCSS.generate(d, this, a)
    }
};
JSWidget.prototype.init = function () {};
var JSWidgetList = function () {
    this.class_name = "js_widget_list"
};
_.inherit(JSWidgetList, JSWidget);
JSWidgetList.prototype.create = function (a) {
    JSWidgetList.superclass.create.call(this, a);
    this.widgets = [];
    return this
};
JSWidgetList.prototype.append = function (a, d, b) {
    this.widgets.push(a);
    void 0 !== b ? b.html(a.container) : b = a.container;
    (d || this.appendTo || this.container).append(b)
};
JSWidgetList.prototype.replace = function (a, d) {
    var b = _.indexOf(this.widgets, a); - 1 < b && (d.container.insertBefore(a.container), a.container.remove(), this.widgets[b] = d);
    return -1 < b
};
JSWidgetList.prototype.clear = function () {
    (this.appendTo || this.container).html("");
    this.widgets = []
};
JSWidgetList.prototype.remove_item = function (a) {
    a = _.indexOf(this.widgets, a); - 1 < a && this.widgets.splice(a, 1)[0].container.remove();
    return -1 < a
};
JSWidgetList.prototype.sort = function (a, d) {
    this.widgets = this.widgets.sort(function (b, c) {
        b = a(b);
        c = a(c);
        return b < c ? -1 : b > c ? 1 : 0
    });
    if (d) this.widgets = this.widgets.reverse();
    _.each(this.widgets, function (a) {
        this.appendTo.append(a.container)
    }, this)
};
JSWidgetList.prototype.at = function (a) {
    return this.widgets[a]
};
JSWidgetList.prototype.each = function (a, d) {
    _.each(this.widgets, a, d)
};
JSWidgetList.prototype.map = function (a, d) {
    return _.map(this.widgets, a, d)
};
JSWidgetList.prototype.find = function (a, d) {
    return _.find(this.widgets, a, d)
};
JSWidgetList.prototype.filter = function (a, d) {
    return _.filter(this.widgets, a, d)
};
JSWidgetList.prototype.count = function () {
    return this.widgets.length
};
JSWidgetList.prototype.insert = function (a, d) {
    if (_.isUndefined(d)) throw "position is a required argument";
    if (d > this.widgets.length || 0 > d) throw "invalid position: " + d;
    0 === d ? 0 === this.widgets.length ? this.append(a) : (a.container.insertBefore(this.widgets[0].container), this.widgets = [a].concat(this.widgets)) : (a.container.insertAfter(this.widgets[d - 1].container), this.widgets.splice(d, 0, a))
};
JSWidgetList.prototype.indexOf = function (a) {
    return _.indexOf(this.widgets, a)
};
JSWidgetList.prototype.bindings = function () {
    var a = this;
    this.container.bind("remove_item", function (d, b) {
        d.stopPropagation();
        a.remove_item(b)
    })
};
var Badge = function (a, d, b) {
    this.class_name = "badge_container";
    this.default_options = {
        from: "partner",
        switcher: !0
    };
    this.create(a, d, b)
};
_.inherit(Badge, JSWidget);
Badge.prototype.create = function (a, d, b) {
    Badge.superclass.create.call(this, a);
    this.callback = b || function () {};
    this.options = _.extend(this.default_options, d);
    this.url = "http://mixpanel.com/f/" + this.options.from;
    this.root_path = "/site_media/images/partner";
    this.blue = this.root_path + "/badge_blue.png";
    this.light = this.root_path + "/badge_light.png";
    this.blue_text = "Get blue version";
    this.light_text = "Get light version";
    this.type = 0;
    this.img = $("<img>");
    this.toggle = $("<div>").addClass("toggle");
    this.container.append(this.img);
    this.options.switcher && this.container.append(this.toggle);
    this.set_type(this.type);
    this.bindings();
    return this
};
Badge.prototype.get_html = function (a) {
    return ['<a href="', this.url, '"><img src="http://mixpanel.com', a, '" alt="Mobile Analytics" /></a>'].join("")
};
Badge.prototype.set_type = function (a) {
    this.type = a;
    0 == this.type ? (this.img.attr("src", this.blue), this.toggle.text(this.light_text), this.callback(this.blue, this.get_html(this.blue))) : 1 == this.type && (this.img.attr("src", this.light), this.toggle.text(this.blue_text), this.callback(this.light, this.get_html(this.light)))
};
Badge.prototype.bindings = function () {
    var a = this;
    this.toggle.click(function () {
        a.type = 0 == a.type ? 1 : 0;
        a.set_type(a.type)
    })
};
Badge.prototype.styles = function () {
    return {
        "": {
            display: "inline-block",
            position: "relative"
        },
        ".toggle": {
            "font-size": "9px",
            color: "#41658C",
            cursor: "pointer",
            "margin-left": "8px"
        }
    }
};
_.namespace("mp.widgets", function () {
    function a() {
        this.label_class = d;
        this.body_class = b
    }

    function d() {
        this.disabled = !1
    }

    function b() {
        this.item_class = c;
        this.disabled = !1;
        this.prev_item = this.comparator = void 0
    }

    function c() {
        this.selected = !1
    }
    _.inherit(a, JSWidget);
    a.prototype.create = function (b, c, d) {
        a.superclass.create.call(this, b);
        this.config = _.extend(this.default_config(), d);
        this.default_label = this.container.html();
        this.label = (new this.label_class).create(null, this.config).select(this.default_label);
        this.body =
            (new this.body_class).create(null, this.config);
        this.container.html("").append(this.label.container, this.body.container);
        this.body.fill(c).label_changed(null, this.label);
        this.bindings();
        this.config.select_first && this.body.widgets.length && this.select_item(this.body.widgets[0]);
        _.isUndefined(this.config.selected) || this.select_val(this.config.selected);
        return this
    };
    a.prototype.deselect_all = function () {
        this.label.select(this.default_label);
        this.body.deselect_all()
    };
    a.prototype.default_config = function () {
        return {
            select_first: !1,
            emulate_select: !1,
            menu: !1,
            collapse: !1,
            min_width: 130
        }
    };
    a.prototype.enable = function () {
        this.label.enable();
        this.body.enable()
    };
    a.prototype.disable = function () {
        this.label.disable();
        this.body.disable()
    };
    a.prototype.activate = function () {
        this.label.activate(!1);
        this.body.activate(!1, this.label)
    };
    a.prototype.deactivate = function () {
        this.label.deactivate(!1);
        this.body.deactivate(!1, this.label)
    };
    a.prototype.selected = function () {
        return this.label.val()
    };
    a.prototype.val = a.prototype.selected;
    a.prototype.select_item =
        function (a, b) {
            if (a && (!a.selected || this.config.menu)) this.config.emulate_select && this.label.select(a, b), this.body.select_item(a, b)
    };
    a.prototype.select_val = function (a, b) {
        var c = this.body.get_item_by_val(a);
        return c ? (this.select_item(c, b), !0) : !1
    };
    a.prototype.bindings = function () {
        this.label.container.bind("label-activated", _.bind(this.body.activate, this.body));
        this.label.container.bind("label-deactivated", _.bind(this.body.deactivate, this.body));
        this.body.container.bind("body-deactivated", _.bind(this.label.deactivate,
            this.label));
        this.container.bind("clickoutside", _.bind(this.deactivate, this));
        this.body.container.bind("dropdown-item-selected", _.bind(function (a, b) {
            this.select_item(b);
            this.deactivate(a)
        }, this));
        this.label.container.bind("label-changed", _.bind(this.body.label_changed, this.body))
    };
    a.prototype.onchange = function (a) {
        this.container.bind("item-selected", function (b, c, d) {
            a(c, d)
        })
    };
    a.prototype.update = function (a) {
        var b = this.val();
        this.body.fill(a);
        null !== b && this.select_val(b, !0)
    };
    a.prototype.entries = function () {
        return this.body.entries()
    };
    _.inherit(d, JSWidget);
    d.prototype.create = function (a, b) {
        d.superclass.create.call(this, a);
        this.config = _.extend(this.default_config(), b);
        this.container.addClass("dropdown_label_widget");
        if (_.isUndefined(this.title)) this.title = this.container;
        this.config.collapse || this.title.css("min-width", this.config.min_width);
        this.deactivate(!1);
        this.bindings();
        return this
    };
    d.prototype.default_config = function () {
        return {}
    };
    d.prototype.select = function (a, b) {
        this.item = a;
        this.value = "string" === typeof a ? a : a.val();
        this._set_content(a);
        b || this.container.trigger("label-changed", this);
        return this
    };
    d.prototype._set_content = function (a) {
        this.title.text("string" === typeof a ? a : a.title())
    };
    d.prototype.enable = function () {
        this.disabled = !1;
        this.container.removeClass("disabled")
    };
    d.prototype.disable = function () {
        this.disabled = !0;
        this.container.addClass("disabled")
    };
    d.prototype.activate = function (a) {
        if (!this.disabled) this.active = !0, this.container.addClass("active"), a && this.container.trigger("label-activated", this)
    };
    d.prototype.deactivate = function (a) {
        if (!this.disabled) this.active = !1, this.container.removeClass("active"), a && this.container.trigger("label-deactivated", this)
    };
    d.prototype.toggle_active = function (a) {
        return this.active ? this.deactivate(a) : this.activate(a)
    };
    d.prototype.bindings = function () {
        this.container.mouseup(_.bind(this.toggle_active, this))
    };
    _.inherit(b, JSWidgetList);
    b.prototype.create = function (a, c) {
        b.superclass.create.call(this, a);
        this.config = _.extend(this.default_config(), c);
        if (this.config.sortable) this.comparator = function (a) {
            return a.title().toLowerCase()
        };
        this.container.hide();
        this.deactivate(!1);
        this.bindings();
        this.container.addClass("dropdown_body_widget");
        return this
    };
    b.prototype.default_config = function () {
        return {
            sortable: !1
        }
    };
    b.prototype.bindings = function () {
        this.container.bind("item-removed", _.bind(this.remove_item, this))
    };
    b.prototype.label_changed = function () {};
    b.prototype.fill = function (a) {
        this.clear();
        a = _(a).chain().map(function (a) {
            return (new this.item_class).create(null, this.config).update(a)
        }, this);
        this.config.sortable && (a = a.sortBy(this.comparator));
        a.each(function (a) {
                this.append(a)
            },
            this);
        this.update_items();
        return this
    };
    b.prototype.update_items = function () {
        _.each(this.widgets, function (a, b) {
            0 == b ? a.container.addClass("first") : a.container.removeClass("first");
            b == this.widgets.length - 1 ? a.container.addClass("last") : a.container.removeClass("last")
        }, this)
    };
    b.prototype.remove_item = function () {
        var a = arguments[0];
        2 == arguments.length && (a = arguments[1]);
        this.widgets = _.without(this.widgets, a);
        a.container.remove();
        this.update_items()
    };
    b.prototype.enable = function () {
        this.disabled = !1
    };
    b.prototype.disable =
        function () {
            this.disabled = !0
    };
    b.prototype.activate = function (a, b) {
        if (!this.disabled) return this.active = !0, a && this.container.trigger("body-activated"), this.label_changed(null, b), this.show(), this
    };
    b.prototype.show = function () {
        this.container.show()
    };
    b.prototype.deactivate = function (a) {
        if (!this.disabled) return this.active = !1, a || this.container.trigger("body-deactivated"), this.hide(), this
    };
    b.prototype.hide = function () {
        this.container.hide()
    };
    b.prototype.toggle_active = function (a) {
        this.active ? this.deactivate(a) :
            this.activate(a)
    };
    b.prototype.selected = function () {
        return _.detect(this.widgets, function (a) {
            return a.selected
        })
    };
    b.prototype.deselect_all = function (a) {
        _.each(this.widgets, function (b) {
            b !== a && b.deselect()
        })
    };
    b.prototype.select_item = function (a, b) {
        this.deselect_all(a);
        a.select(!1);
        if (!b) this.container.trigger("item-selected", [a, this.prev_item]), this.prev_item = a
    };
    b.prototype.select_first = function (a) {
        this.widgets.length && this.select_item(this.widgets[0], a)
    };
    b.prototype.select_last = function () {
        this.widgets.length &&
            this.select_item(this.widgets[this.widgets.length - 1])
    };
    b.prototype.select_next = function (a) {
        var b = this.selected();
        _.isArray(b) || (b = _.indexOf(this.widgets, b), b < this.widgets.length - 1 && this.select_item(this.widgets[b + 1], a))
    };
    b.prototype.select_previous = function (a) {
        var b = this.selected();
        if (b) {
            if (_.isArray(b)) return
        } else b = this.widgets[this.widgets.length - 1];
        b = _.indexOf(this.widgets, b);
        0 < b && this.select_item(this.widgets[b - 1], a)
    };
    b.prototype.get_item_by_val = function (a) {
        return _.detect(this.widgets, function (b) {
            if (_.isEqual(b.val(),
                a)) return !0
        })
    };
    _.inherit(c, JSWidget);
    c.prototype.create = function (a, b) {
        c.superclass.create.call(this, a);
        this.enabled = !0;
        this.bindings();
        this.config = _.extend(this.default_config(), b);
        this.container.addClass("dropdown_item_widget");
        return this
    };
    c.prototype.default_config = function () {
        return {}
    };
    c.prototype.bindings = function () {
        this.container.click(_.bind(this.select, this))
    };
    c.prototype.update = function (a) {
        this._set_value(a);
        this._set_content(a);
        return this
    };
    c.prototype._set_value = function (a) {
        this.value = _.isArray(a) ?
            a[0] : a
    };
    c.prototype._set_content = function (a) {
        this.display_value = _.isArray(a) ? a[1] : a;
        this.container.text(this.display_value)
    };
    c.prototype.title = function () {
        return this.display_value
    };
    c.prototype.enable = function () {
        var a = !this.enabled;
        this.enabled = !0;
        this.container.removeClass("disabled");
        return a
    };
    c.prototype.disable = function () {
        var a = this.enabled;
        this.enabled = !1;
        this.container.addClass("disabled");
        return a
    };
    c.prototype.select = function (a) {
        if (this.enabled) a && (!this.selected || this.config.menu) && this.container.trigger("dropdown-item-selected",
            this), this.selected = !0, this.container.addClass("selected")
    };
    c.prototype.deselect = function () {
        var a = this.selected;
        this.selected = !1;
        this.container.removeClass("selected");
        return a
    };
    c.prototype.remove = function () {
        this.deselect();
        this.container.trigger("item-removed", this)
    };
    a.Label = d;
    a.Body = b;
    a.Item = c;
    return {
        Dropdown: a
    }
});
_.namespace("mp.widgets.styled_labels", function () {
    function a() {
        this.class_name = "rounded_dropdown_label"
    }

    function d() {
        this.class_name = "icon_textless_label"
    }
    _.inherit(a, mp.widgets.Dropdown.Label);
    a.prototype.create = function (b, c) {
        this.title = $("<div>").addClass("title");
        this.arrow = $("<div>").addClass("arrow");
        a.superclass.create.call(this, b, c);
        this.container.append(this.title, this.arrow);
        return this
    };
    _.inherit(d, mp.widgets.Dropdown.Label);
    d.prototype.create = function (a, c) {
        d.superclass.create.call(this,
            a, c);
        this.icon = $("<div>").addClass("icon");
        this.arrow = $("<div>").addClass("arrow");
        this.container.append(this.icon, this.arrow);
        return this
    };
    d.prototype._set_content = function (a) {
        this.icon.attr({
            "class": "icon " + a.value
        })
    };
    return {
        Rounded: a,
        IconTextless: d
    }
});
_.namespace("mp.widgets.dropdowns", function () {
    function a() {
        this.class_name = "mp_checkbox_dropdown";
        this.label_class = d;
        this.body_class = b
    }

    function d() {}

    function b() {
        this.item_class = c
    }

    function c() {
        this.class_name = "checkbox_dropdown_item"
    }
    _.inherit(a, mp.widgets.Dropdown);
    a.prototype.create = function () {
        a.superclass.create.apply(this, arguments);
        this.selected_items = [];
        this.update_width();
        return this
    };
    a.prototype.bindings = function () {
        a.superclass.bindings.call(this);
        this.container.bind("label-activated", _.bind(this.update_width,
            this));
        this.body.container.bind("dropdown-item-deselected", _.bind(function (a, b) {
            this.selected_items = _.without(this.selected_items, b);
            this.update_label();
            this.container.trigger("item-deselected", b)
        }, this))
    };
    a.prototype.select_values = function (a, b) {
        _.each(a, function (a) {
            this.select_val(a, b)
        }, this)
    };
    a.prototype.select_item = function (a, b) {
        if (!a.selected || this.config.menu) this.selected_items.push(a), this.update_label(b), this.body.select_item(a, b)
    };
    a.prototype.update_label = function (a) {
        this.config.emulate_select &&
            this.label.select(this.selected_items, a);
        this.update_width()
    };
    a.prototype.update = function (a) {
        this.body.fill(a)
    };
    a.prototype.update_width = function () {
        var a = this.label.container.width();
        this.body.container.css("width", "auto");
        this.body.container.width() < a && this.body.container.width(a)
    };
    a.prototype.default_config = function () {
        return _.extend(a.superclass.default_config.call(this), {
            emulate_select: !0
        })
    };
    a.prototype.deactivate = function (b) {
        b && "dropdown-item-selected" == b.type || a.superclass.deactivate.call(this)
    };
    a.prototype.onchange = function (a) {
        var b = this;
        this.container.bind("item-selected", function () {
            a(b.selected_items)
        });
        this.container.bind("item-deselected", function () {
            a(b.selected_items)
        })
    };
    _.inherit(d, mp.widgets.Dropdown.Label);
    d.prototype.select = function (a, b) {
        this.value = _.isArray(a) ? _.map(a, function (a) {
            return a.val()
        }) : [];
        if ("string" == typeof a && !this.default_title) this.default_title = a;
        this._set_content(a);
        b || this.container.trigger("label-changed", this);
        return this
    };
    d.prototype._set_content = function (a) {
        a = !_.isArray(a) || 0 === a.length ? this.default_title : 1 === a.length ? "string" === typeof a[0] ? a[0] : a[0].title() : a.length + " selected";
        d.superclass._set_content.call(this, a)
    };
    _.inherit(b, mp.widgets.Dropdown.Body);
    b.prototype.select_item = function (a, b) {
        a.select(!1);
        b || this.container.trigger("item-selected", a)
    };
    _.inherit(c, mp.widgets.Dropdown.Item);
    c.prototype.default_config = function () {
        return {}
    };
    c.prototype.create = function (a, b) {
        c.superclass.create.call(this, a, b);
        this.checkmark = $("<img>").attr("src", "//cdn.mxpnl.com/cache/c836b2de4e8e30cc982c89953c5737c3/images/icons/grey-check.png").addClass("checkmark");
        this.check_wrap = $("<div>").addClass("checkmark_spacer");
        this.check_wrap.html(this.checkmark);
        this.content = $("<span>");
        this.container.html(this.check_wrap).append(this.content);
        return this
    };
    c.prototype._set_content = function (a) {
        this.display_value = _.isArray(a) ? a[1] : a;
        this.content.text(this.display_value).attr("title", this.display_value)
    };
    c.prototype.select = function (a) {
        this.selected ? this.deselect() : c.superclass.select.call(this, a)
    };
    c.prototype.deselect = function (a) {
        c.superclass.deselect.call(this);
        a ||
            this.container.trigger("dropdown-item-deselected", this)
    };
    a.Label = d;
    a.Body = b;
    a.Item = c;
    return {
        Checkbox: a
    }
});
_.namespace("mp.widgets.dropdowns", function () {
    function a() {
        this.class_name = "rounded_dropdown";
        this.label_class = mp.widgets.styled_labels.Rounded;
        this.body_class = d
    }

    function d() {
        this.class_name = "rounded_dropdown_body";
        this.item_class = b
    }

    function b() {
        this.class_name = "rounded_dropdown_item"
    }
    _.inherit(a, mp.widgets.Dropdown);
    a.prototype.default_config = function () {
        return _.extend(a.superclass.default_config.call(this), {
            emulate_select: !0
        })
    };
    _.inherit(d, mp.widgets.Dropdown.Body);
    d.prototype.label_changed = function (a,
        b) {
        this.container.css("min-width", b.container.outerWidth() - 2)
    };
    _.inherit(b, mp.widgets.Dropdown.Item);
    b.prototype.create = function () {
        b.superclass.create.apply(this, arguments);
        this.config.type_icons ? (this.icon_container = $("<div>").addClass("icon_container"), this.content = $("<div>").addClass("word_container"), this.container.append(this.icon_container, this.content)) : this.content = this.container;
        return this
    };
    b.prototype.default_config = function () {
        return {
            type_icons: !1
        }
    };
    b.prototype._set_content = function (a) {
        this.display_value =
            _.isArray(a) ? a[1] : a;
        this.content.text(this.display_value).attr("title", this.display_value);
        if (this.config.type_icons) 3 <= a.length ? (this.icon_container.addClass(a[2]), this.type = a[2]) : (this.icon_container.addClass("unknown"), this.type = "unknown")
    };
    a.Label = mp.widgets.styled_labels.Rounded;
    a.Body = d;
    a.Item = b;
    return {
        Rounded: a
    }
});
_.namespace("mp.widgets.dropdowns", function (a) {
    function d() {
        this.class_name = "rounded_checkbox_dropdown";
        this.label_class = b;
        this.body_class = c
    }

    function b() {
        this.class_name = "rounded_checkbox_label"
    }

    function c() {
        this.class_name = "rounded_checkbox_body";
        this.item_class = f
    }

    function f() {
        this.class_name = "rounded_checkbox_item"
    }
    _.inherit(d, a.Checkbox);
    d.prototype.default_config = function () {
        return _.extend(d.superclass.default_config.call(this), {
            filterable: !0
        })
    };
    d.prototype.bindings = function () {
        d.superclass.bindings.apply(this,
            arguments);
        this.body.container.delegate(".search_box", "keydown", _.bind(function (a) {
            switch (a.which) {
            case 27:
                this.label.item && "string" !== typeof this.label.item && this.body.select_item(this.label.item, !0);
                this.deactivate();
                break;
            case 9:
            case 13:
                this.select_if_one_visible()
            }
        }, this))
    };
    d.prototype.select_if_one_visible = function () {
        if (1 === this.body.visible().length) {
            var a = this.body.visible()[0];
            a.selected ? a.deselect() : this.select_item(a);
            this.body.deactivate()
        }
    };
    _.inherit(b, a.Checkbox.Label);
    b.prototype.create =
        function (a, c) {
            this.title = $("<div>").addClass("title");
            this.arrow = $("<div>").addClass("arrow");
            b.superclass.create.call(this, a, c);
            this.container.append(this.title, this.arrow);
            return this
    };
    b.prototype.styles = a.Rounded.Label.prototype.styles;
    _.inherit(c, a.Checkbox.Body);
    c.prototype.styles = a.Rounded.Body.prototype.styles;
    c.prototype.create = function (a, b) {
        c.superclass.create.call(this, a, b);
        this.config.collapse || this.container.css("min-width", this.config.min_width + 38);
        var d = $("<div>").addClass("search_box_container");
        this.search = $("<input />").addClass("search_box");
        this.content = $("<div>").addClass("content");
        !0 === this.config.filterable && this.container.append(d.append(this.search));
        this.container.append(this.content);
        this.appendTo = this.content;
        return this
    };
    c.prototype.bindings = function () {
        c.superclass.bindings.apply(this, arguments);
        this.container.delegate(".search_box", "keyup", _.bind(this.filter, this))
    };
    c.prototype.visible = function () {
        var a = [];
        _.each(this.widgets, function (b) {
            b.container.is(":visible") && a.push(b)
        });
        return a
    };
    var k = function (a) {
        var b = a.toLowerCase();
        return function (c) {
            c = c.toLowerCase();
            return 1 === a.length && _.startsWith(c, b) || 1 !== a.length && _.includes(c, b)
        }
    };
    c.prototype.filter = function (a) {
        if (a && _.include([9, 13, 38, 40], a.which)) a.preventDefault();
        else {
            var a = this.search.val(),
                b = k(a);
            _.each(this.widgets, function (a) {
                b(a.display_value) ? a.container.show() : a.container.hide()
            })
        }
    };
    c.prototype.activate = function () {
        c.superclass.activate.apply(this, arguments);
        this.scroll_to_selected();
        this.search.attr("value",
            "").focus();
        this.filter(void 0, !0);
        return this
    };
    c.prototype.scroll_to_selected = function () {
        var a = this.selected();
        a && !_.isArray(a) && this.appendTo.scrollTo(a.container, {
            offset: {
                top: -10 * a.container.height()
            }
        })
    };
    c.prototype.select_item = function (a, b) {
        c.superclass.select_item.apply(this, arguments);
        this.scroll_to_selected()
    };
    d.filter_predicate_from_query = k;
    _.inherit(f, a.Checkbox.Item);
    d.Label = b;
    d.Body = c;
    return {
        RoundedCheckbox: d
    }
});
(function (a, d, b) {
    function c(c, k) {
        function h(b) {
            a(m).each(function () {
                var c = a(this);
                this !== b.target && !c.has(b.target).length && c.triggerHandler(k, [b.target])
            })
        }
        var k = k || c + b,
            m = a(),
            l = c + "." + k + "-special-event";
        a.event.special[k] = {
            setup: function () {
                m = m.add(this);
                1 === m.length && a(d).bind(l, h)
            },
            teardown: function () {
                m = m.not(this);
                0 === m.length && a(d).unbind(l)
            },
            add: function (a) {
                var b = a.handler;
                a.handler = function (a, c) {
                    a.target = c;
                    b.apply(this, arguments)
                }
            }
        }
    }
    a.map("click dblclick mousemove mousedown mouseup mouseover mouseout change select submit keydown keypress keyup".split(" "),
        function (a) {
            c(a)
        });
    c("focusin", "focus" + b);
    c("focusout", "blur" + b);
    a.addOutsideEvent = c
})(jQuery, document, "outside");
mp.cookie = {};
mp.cookie.set = function (a, d, b, c) {
    var f = new Date,
        c = c ? this._parse_domain(document.location.hostname) : "",
        a = a + "=" + escape(d);
    f.setDate(f.getDate() + b);
    a += null === b ? "" : ";expires=" + f.toGMTString();
    document.cookie = a + "; path=/" + (c ? ";domain=." + c : "")
};
mp.cookie.remove = function (a, d) {
    mp.cookie.set(a, "", -1, d)
};
mp.cookie.get = function (a) {
    if (0 < document.cookie.length) {
        var d = document.cookie.indexOf(a + "=");
        if (-1 != d) {
            d = d + a.length + 1;
            a = document.cookie.indexOf(";", d);
            if (-1 == a) a = document.cookie.length;
            return unescape(document.cookie.substring(d, a))
        }
    }
    return ""
};
mp.cookie.exists = function (a) {
    return 0 < document.cookie.length && -1 != document.cookie.indexOf(a + "=") ? !0 : !1
};
mp.cookie._parse_domain = function (a) {
    return (a = a.match(/[a-z0-9][a-z0-9\-]+\.[a-z\.]{2,6}$/i)) ? a[0] : ""
};
_.namespace("mp.header_menu", function (a) {
    a.bind_dropdown = function (a) {
        function b() {
            c.removeClass("active");
            f.hide()
        }
        var c = a.children(".label"),
            f = a.children(".body"),
            k = a.children(".resize");
        a.children(".label").click(function () {
            c.hasClass("active") ? b() : (c.addClass("active"), f.show(), k.width(c.width()))
        });
        a.bind("clickoutside", b);
        a.find(".body a").click(b)
    };
    a.bind_project_create_menu = function () {
        var a = $("#id_name");
        a.bind("input", function () {
            var b = $("#create_submit"),
                c = $("#plus");
            0 < a.val().length ? (b.removeClass("disabled"),
                b.attr("disabled", !1), a.addClass("hastext"), c.addClass("hastext")) : b.attr("disabled") || (b.addClass("disabled"), b.attr("disabled", !0), a.removeClass("hastext"), c.removeClass("hastext"))
        });
        $(window).bind("keydown", function (a) {
            27 == a.which && (a = $("#project_menu"), a.children(".label").removeClass("active"), a.children(".body").hide())
        })
    }
});
mp.modules = {};
mp.modules.loadJS = function (a) {
    var d = document.createElement("script");
    d.setAttribute("type", "text/javascript");
    d.setAttribute("src", a);
    mp.modules.appendToHead(d)
};
mp.modules.loadCSS = function (a) {
    var d = document.createElement("link");
    d.setAttribute("rel", "stylesheet");
    d.setAttribute("type", "text/css");
    d.setAttribute("href", a);
    mp.modules.appendToHead(d)
};
mp.modules.appendToHead = function (a) {
    document.getElementsByTagName("head")[0].appendChild(a)
};
_.namespace("mp.utility", function (a) {
    a.parseUri = function (b) {
        for (var c = a.parseUri.options, b = c.parser[c.strictMode ? "strict" : "loose"].exec(b), d = {}, k = 14; k--;) d[c.key[k]] = b[k] || "";
        d[c.q.name] = {};
        d[c.key[12]].replace(c.q.parser, function (a, b, k) {
            b && (d[c.q.name][b] = k)
        });
        return d
    };
    a.parseUri.options = {
        strictMode: !1,
        key: "source,protocol,authority,userInfo,user,password,host,port,relative,path,directory,file,query,anchor".split(","),
        q: {
            name: "queryKey",
            parser: /(?:^|&)([^&=]*)=?([^&]*)/g
        },
        parser: {
            strict: /^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,
            loose: /^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/
        }
    };
    var d = /^([a-z][a-z0-9\*\-\.]*):\/\/(?:(?:(?:[\w\.\-\+!$&'\(\)*\+,;=]|%[0-9a-f]{2})+:)*(?:[\w\.\-\+%!$&'\(\)*\+,;=]|%[0-9a-f]{2})+@)?(?:(?:[a-z0-9\-\.]|%[0-9a-f]{2})+|(?:\[(?:[0-9a-f]{0,4}:)*(?:[0-9a-f]{0,4})\]))(?::[0-9]+)?(?:[\/|\?](?:[\w#!:\.\?\+=&@!$'~*,;\/\(\)\[\]\-]|%[0-9a-f]{2})*)?$/i;
    a.isURL =
        function (a) {
            return d.test(a)
    };
    a.sanitize = function (a) {
        return "undefined" != typeof $ ? $("<div/>").text(a).html() : a.replace(/&/g, "&amp;").replace(/>/g, "&gt;").replace(/</g, "&lt;")
    };
    a.percentage_to_int = function (a) {
        a = /(\d{0,3})\s*%/.exec(a)[1];
        return parseInt(a)
    };
    a.http_build_query = function (a, c) {
        var d, k, h, m = 0,
            l = [];
        c || (c = "&");
        for (d in a) d && (k = encodeURIComponent(a[d].toString()), h = encodeURIComponent(d), l[m++] = h + "=" + k);
        return l.join(c)
    };
    a.shorten_string = function (a, c) {
        c || (c = 20);
        return a.length > c ? a.substring(0,
            c) + "..." : a
    };
    a.truncate_middle = function (a, c) {
        return a.length > c ? _.splice(a, c / 2, a.length - c, "...") : a
    };
    a.commaize = function (b, c) {
        c || (c = 3);
        for (var d = 0 > b ? !0 : !1, b = Math.abs(b).toString(), k = b.split("."), b = a.strrev(k[0]), h = 0, m = []; h < b.length;) m.push(b[h]), 0 == (h + 1) % c && h + 1 != b.length && m.push(","), h++;
        m = m.reverse("").join("");
        k[1] && (m += "." + k[1]);
        d && (m = "-" + m);
        return m
    };
    a.abbrev_num = function (b, c) {
        var d = a.commaize,
            c = void 0 === c ? 1 : c;
        return 1E6 <= b ? d(parseFloat(b / 1E6).toFixed(c)) + "M" : 1E4 <= b ? d(parseFloat(b / 1E3).toFixed(c)) +
            "K" : d(parseFloat(b).toFixed(c))
    };
    a.pretty_number = function (b) {
        var b = parseFloat(b),
            c = "";
        1E6 <= Math.abs(b) ? (b /= 1E6, c = "M") : 1E3 <= Math.abs(b) && (b /= 1E3, c = "K");
        b = a.commaize(b.toFixed(1));
        0 == b % 1 && (b = parseInt(b));
        return b + c
    };
    a.pretty_file_size = function (a) {
        if (0 === a) return "0 Bytes";
        var c = Math.floor(Math.log(a) / Math.log(1024));
        return Math.round(a / Math.pow(1024, c)) + " " + ["Bytes", "KB", "MB", "GB", "TB"][c]
    };
    a.ordinalize = function (a) {
        var c = Math.abs(a);
        if (_.include([11, 12, 13], c % 100)) return a + "th";
        switch (c % 10) {
        case 1:
            return a +
                "st";
        case 2:
            return a + "nd";
        case 3:
            return a + "rd";
        default:
            return a + "th"
        }
    };
    a.format_numeric_bucket = function (b) {
        b = b.split(" - ");
        return a.pretty_number(b[0]) + " - " + a.pretty_number(b[1])
    };
    a.expand_num = function (a) {
        var a = a.replace(",", ""),
            c = a.slice(0, a.length - 1);
        return /.*M$/.test(a) ? 1E6 * parseFloat(c) : /.*K$/.test(a) ? 1E3 * parseFloat(c) : parseFloat(a)
    };
    a.strrev = function (a) {
        return a.split("").reverse().join("")
    };
    a.deep_copy = function () {
        var a = {}, c, d, k = {}, h;
        for (c = arguments.length - 1; 0 <= c; c--)
            if ("undefined" != typeof arguments[c])
                if (null !==
                    arguments[c] && "object" == typeof arguments[c] && arguments[c].constructor != Array)
                    for (d in arguments[c]) arguments[c].hasOwnProperty(d) && (k[d] = !0);
                else return arguments[c];
        for (d in k)
            if (k.hasOwnProperty(d)) {
                h = [];
                for (c = 0; c < arguments.length; c++) "undefined" != typeof arguments[c] && h.push(arguments[c][d]);
                a[d] = arguments.callee.apply(this, h)
            }
        return a
    };
    a.floatformat = function (a, c) {
        if ("number" == typeof a) {
            var d = a.toFixed(c),
                k = parseInt(d, 10);
            return 0 == d - k ? k : d
        }
        return a
    };
    a.parse_domain = function (a) {
        var a = a.split("/"),
            c = "";
        2 <= a.length && (c = a[2]);
        return c
    };
    a.default_date_format = "yyyy-MM-dd";
    a.to_localized_date = function (a) {
        if (_.isNaN(mp.report.globals.utc_offset)) throw "utc_offset not set";
        return (new Date(a.getUTCFullYear(), a.getUTCMonth(), a.getUTCDate(), a.getUTCHours(), a.getUTCMinutes(), a.getUTCSeconds(), a.getUTCMilliseconds())).addMinutes(mp.report.globals.utc_offset)
    };
    a.to_localized_date_string = function (a) {
        return mp.utility.to_localized_date(a).toString(this.default_date_format)
    };
    a.date_to_ms_epoch = function (a) {
        var a =
            a.split(" "),
            c = a[0].split("-");
        if (a[1]) var d = a[1].split(":");
        "0" == c[1][0] && (c[1] = c[1][1]);
        return d ? (new Date(c[0], parseInt(c[1]) - 1, c[2], d[0], d[1], d[2])).getTime() : (new Date(c[0], parseInt(c[1]) - 1, c[2])).getTime()
    };
    a.prepare_event_names_for_dropdown = function (a) {
        return a = _(a).chain().map(function (a) {
            return [a, mp.utility.rename_mp_event(a)]
        }).sortBy(function (a) {
            return a[1].toLowerCase()
        }).value()
    };
    a.rename_mp_event = function (a) {
        var c = {
            $campaign_delivery: "Notification Sent",
            $campaign_open: "Notification Opened"
        };
        return c.hasOwnProperty(a) ? c[a] : a
    };
    a.rename_mp_property = function (a, c) {
        mapping = {
            mp_browser: "Browser",
            mp_country_code: "Country",
            mp_keyword: "Search Keyword",
            mp_page: "Page View",
            mp_platform: "Platform",
            mp_referrer: "Referrer",
            $browser: "Browser",
            $city: "City",
            $country_code: "Country",
            $created: "Created",
            $device: "Device",
            $email: "Email",
            $first_name: "First Name",
            $initial_referrer: "Initial Referrer",
            $initial_referring_domain: "Initial Referring Domain",
            $last_login: "Last Login",
            $last_name: "Last Name",
            $last_seen: "Last Seen",
            $os: "Operating System",
            $referrer: "Referrer",
            $referring_domain: "Referring Domain",
            $region: "Region",
            $search_engine: "Search Engine",
            $username: "Username"
        };
        return mapping.hasOwnProperty(a) ? mapping[a] : ("$campaign_delivery" === c || _.isArray(c) && -1 != _.indexOf(c, "$campaign_delivery")) && "campaign_id" == a ? "Notification" : "$" === a[0] && 1 < a.length ? _.map(a.substr(1).split("_"), function (a) {
            return a[0].toUpperCase() + a.substr(1)
        }).join(" ") : a
    };
    a.get_campaign_name = function (a) {
        var c;
        for (c = 0; c < mp.report.globals.project_campaigns.length; c++) {
            var d =
                mp.report.globals.project_campaigns[c];
            if (a == d[0]) return d[1]
        }
        return a
    };
    a.country_codes = {
        A1: "Anonymous Proxy",
        A2: "Satellite Provider",
        O1: "Other Country",
        AD: "Andorra",
        AE: "United Arab Emirates",
        AF: "Afghanistan",
        AG: "Antigua and Barbuda",
        AI: "Anguilla",
        AL: "Albania",
        AM: "Armenia",
        AN: "Netherlands Antilles",
        AO: "Angola",
        AP: "Asia/Pacific Region",
        AQ: "Antarctica",
        AR: "Argentina",
        AS: "American Samoa",
        AT: "Austria",
        AU: "Australia",
        AW: "Aruba",
        AX: "Aland Islands",
        AZ: "Azerbaijan",
        BA: "Bosnia and Herzegovina",
        BB: "Barbados",
        BD: "Bangladesh",
        BE: "Belgium",
        BF: "Burkina Faso",
        BG: "Bulgaria",
        BH: "Bahrain",
        BI: "Burundi",
        BJ: "Benin",
        BL: "Saint Bartelemey",
        BM: "Bermuda",
        BN: "Brunei Darussalam",
        BO: "Bolivia",
        BR: "Brazil",
        BS: "Bahamas",
        BT: "Bhutan",
        BV: "Bouvet Island",
        BW: "Botswana",
        BY: "Belarus",
        BZ: "Belize",
        CA: "Canada",
        CC: "Cocos (Keeling) Islands",
        CD: "Congo, The Democratic Republic of the",
        CF: "Central African Republic",
        CG: "Congo",
        CH: "Switzerland",
        CI: "Cote d'Ivoire",
        CK: "Cook Islands",
        CL: "Chile",
        CM: "Cameroon",
        CN: "China",
        CO: "Colombia",
        CR: "Costa Rica",
        CU: "Cuba",
        CV: "Cape Verde",
        CX: "Christmas Island",
        CY: "Cyprus",
        CZ: "Czech Republic",
        DE: "Germany",
        DJ: "Djibouti",
        DK: "Denmark",
        DM: "Dominica",
        DO: "Dominican Republic",
        DZ: "Algeria",
        EC: "Ecuador",
        EE: "Estonia",
        EG: "Egypt",
        EH: "Western Sahara",
        ER: "Eritrea",
        ES: "Spain",
        ET: "Ethiopia",
        EU: "Europe",
        FI: "Finland",
        FJ: "Fiji",
        FK: "Falkland Islands (Malvinas)",
        FM: "Micronesia, Federated States of",
        FO: "Faroe Islands",
        FR: "France",
        FX: "France, Metropolitan",
        GA: "Gabon",
        GB: "United Kingdom",
        GD: "Grenada",
        GE: "Georgia",
        GF: "French Guiana",
        GG: "Guernsey",
        GH: "Ghana",
        GI: "Gibraltar",
        GL: "Greenland",
        GM: "Gambia",
        GN: "Guinea",
        GP: "Guadeloupe",
        GQ: "Equatorial Guinea",
        GR: "Greece",
        GS: "South Georgia and the South Sandwich Islands",
        GT: "Guatemala",
        GU: "Guam",
        GW: "Guinea-Bissau",
        GY: "Guyana",
        HK: "Hong Kong",
        HM: "Heard Island and McDonald Islands",
        HN: "Honduras",
        HR: "Croatia",
        HT: "Haiti",
        HU: "Hungary",
        ID: "Indonesia",
        IE: "Ireland",
        IL: "Israel",
        IM: "Isle of Man",
        IN: "India",
        IO: "British Indian Ocean Territory",
        IQ: "Iraq",
        IR: "Iran, Islamic Republic of",
        IS: "Iceland",
        IT: "Italy",
        JE: "Jersey",
        JM: "Jamaica",
        JO: "Jordan",
        JP: "Japan",
        KE: "Kenya",
        KG: "Kyrgyzstan",
        KH: "Cambodia",
        KI: "Kiribati",
        KM: "Comoros",
        KN: "Saint Kitts and Nevis",
        KP: "Korea, Democratic People's Republic of",
        KR: "Korea, Republic of",
        KW: "Kuwait",
        KY: "Cayman Islands",
        KZ: "Kazakhstan",
        LA: "Lao People's Democratic Republic",
        LB: "Lebanon",
        LC: "Saint Lucia",
        LI: "Liechtenstein",
        LK: "Sri Lanka",
        LR: "Liberia",
        LS: "Lesotho",
        LT: "Lithuania",
        LU: "Luxembourg",
        LV: "Latvia",
        LY: "Libyan Arab Jamahiriya",
        MA: "Morocco",
        MC: "Monaco",
        MD: "Moldova, Republic of",
        ME: "Montenegro",
        MF: "Saint Martin",
        MG: "Madagascar",
        MH: "Marshall Islands",
        MK: "Macedonia",
        ML: "Mali",
        MM: "Myanmar",
        MN: "Mongolia",
        MO: "Macao",
        MP: "Northern Mariana Islands",
        MQ: "Martinique",
        MR: "Mauritania",
        MS: "Montserrat",
        MT: "Malta",
        MU: "Mauritius",
        MV: "Maldives",
        MW: "Malawi",
        MX: "Mexico",
        MY: "Malaysia",
        MZ: "Mozambique",
        NA: "Namibia",
        NC: "New Caledonia",
        NE: "Niger",
        NF: "Norfolk Island",
        NG: "Nigeria",
        NI: "Nicaragua",
        NL: "Netherlands",
        NO: "Norway",
        NP: "Nepal",
        NR: "Nauru",
        NU: "Niue",
        NZ: "New Zealand",
        OM: "Oman",
        PA: "Panama",
        PE: "Peru",
        PF: "French Polynesia",
        PG: "Papua New Guinea",
        PH: "Philippines",
        PK: "Pakistan",
        PL: "Poland",
        PM: "Saint Pierre and Miquelon",
        PN: "Pitcairn",
        PR: "Puerto Rico",
        PS: "Palestinian Territory",
        PT: "Portugal",
        PW: "Palau",
        PY: "Paraguay",
        QA: "Qatar",
        RE: "Reunion",
        RO: "Romania",
        RS: "Serbia",
        RU: "Russian Federation",
        RW: "Rwanda",
        SA: "Saudi Arabia",
        SB: "Solomon Islands",
        SC: "Seychelles",
        SD: "Sudan",
        SE: "Sweden",
        SG: "Singapore",
        SH: "Saint Helena",
        SI: "Slovenia",
        SJ: "Svalbard and Jan Mayen",
        SK: "Slovakia",
        SL: "Sierra Leone",
        SM: "San Marino",
        SN: "Senegal",
        SO: "Somalia",
        SR: "Suriname",
        ST: "Sao Tome and Principe",
        SV: "El Salvador",
        SY: "Syrian Arab Republic",
        SZ: "Swaziland",
        TC: "Turks and Caicos Islands",
        TD: "Chad",
        TF: "French Southern Territories",
        TG: "Togo",
        TH: "Thailand",
        TJ: "Tajikistan",
        TK: "Tokelau",
        TL: "Timor-Leste",
        TM: "Turkmenistan",
        TN: "Tunisia",
        TO: "Tonga",
        TR: "Turkey",
        TT: "Trinidad and Tobago",
        TV: "Tuvalu",
        TW: "Taiwan",
        TZ: "Tanzania, United Republic of",
        UA: "Ukraine",
        UG: "Uganda",
        UM: "United States Minor Outlying Islands",
        US: "United States",
        UY: "Uruguay",
        UZ: "Uzbekistan",
        VA: "Holy See (Vatican City State)",
        VC: "Saint Vincent and the Grenadines",
        VE: "Venezuela",
        VG: "Virgin Islands, British",
        VI: "Virgin Islands, U.S.",
        VN: "Vietnam",
        VU: "Vanuatu",
        WF: "Wallis and Futuna",
        WS: "Samoa",
        YE: "Yemen",
        YT: "Mayotte",
        ZA: "South Africa",
        ZM: "Zambia",
        ZW: "Zimbabwe"
    };
    a.get_country_name = function (b) {
        var c = a.country_codes,
            d = b.toUpperCase();
        return c.hasOwnProperty(d) ? c[d] : b
    };
    a.log = mp.globals.debug && window.console && console.log && console.log.apply ? _.bind(console.log, console) : function () {};
    a.warn = mp.globals.debug && window.console && console.warn && console.warn.apply ? _.bind(console.warn, console) : function () {};
    a.error = mp.globals.debug && window.console && console.error && console.error.apply ? _.bind(console.error, console) : function () {};
    a.group = mp.globals.debug && window.console && console.group && console.group.apply ? _.bind(console.group, console) : a.log;
    a.groupCollapsed = mp.globals.debug && window.console && console.groupCollapsed && console.groupCollapsed.apply ? _.bind(console.groupCollapsed, console) : a.log;
    a.groupEnd =
        mp.globals.debug && window.console && console.groupEnd && console.groupEnd.apply ? _.bind(console.groupEnd, console) : function () {};
    a.timer = {
        start_times: {},
        start: function (a) {
            a = a || Math.random();
            this.start_times[a] = (new Date).getTime();
            return a
        },
        stop: function (a) {
            var c = (new Date).getTime() - this.start_times[a];
            delete this.start_times[a];
            return c
        }
    };
    a.string_time = function (a) {
        var c = a / 60,
            d = c / 60,
            k = d / 24,
            h = k / 7;
        return isNaN(a) ? "?" : 60 > a ? "less than a minute" : 90 > c ? c.toFixed(0) + " min." : 36 > d ? d.toFixed(0) + " hours" : 11 > k ? k.toFixed(0) +
            " days" : h.toFixed(0) + " weeks"
    };
    a.time_since_date = function (b) {
        return a.string_time((new Date - b) / 1E3)
    };
    a.recursive_merge = function (a, c) {
        var d = {};
        _.each(a, function (a, b) {
            d[b] = _.extend(a, c[b] || {})
        });
        _.each(_.reject(c, function (a, b) {
            return d.hasOwnProperty(b)
        }), function (a, b) {
            d[b] = a
        });
        return d
    };
    a.format_duration = function (a) {
        if (60 > a) var c = " second";
        else 3600 > a ? (a = Math.floor(a / 60), c = " minute") : 86400 > a ? (a = (a / 60 / 60).toFixed(1), c = " hour") : (a = (a / 60 / 60 / 24).toFixed(1), c = " day");
        1 != a && (c += "s");
        return a + c
    };
    a.set_flag =
        function (a) {
            $.get("/set_flag/", {
                flag: a
            });
            mp.report.globals.flags[a] = a
    };
    a.throttle = function (a, c, d) {
        var k;
        return function () {
            var h = d || this,
                m = arguments,
                l = function () {
                    u();
                    a.apply(h, m)
                }, u = function () {
                    k = null
                };
            clearTimeout(k);
            k ? k = setTimeout(l, c) : (a.apply(h, m), k = setTimeout(u, c))
        }
    };
    a.darken_color = function (a) {
        "#" == a[0] && (a = a.substring(1));
        for (var a = parseInt(a, 16), a = (Math.max((a & 255) - 30, 0) | Math.max((a >> 8 & 255) - 30, 0) << 8 | Math.max((a >> 16 & 255) - 30, 0) << 16).toString(16), c = 0; c < 6 - a.length; c++) a = "0" + a;
        return "#" + a
    };
    a.compute_sig =
        function (a) {
            a.api_key = mp.report.globals.api_key;
            var c = (new Date).getTime() + mp.report.globals.local_offset;
            a.expire = Math.ceil(c / 1E3) + 3600;
            c = _.keys(a).sort();
            c = _.reduce(c, function (c, d) {
                return c + d + "=" + a[d]
            }, "");
            c += mp.report.globals.api_secret;
            a.sig = hex_md5(c)
    };
    a.property_values_limit = function () {
        return 255
    };
    a.is_valid_email = function (a) {
        return /^[+a-zA-Z0-9_.-]+@([a-zA-Z0-9-]+\.)+[a-zA-Z0-9]{2,6}$/.test(a)
    };
    a.strip_spaces_between_tags = function (a) {
        return a.replace(/>\s+</g, "><")
    };
    a.arb_escape = function (a,
        c) {
        if (!_.isString(a)) return JSON.stringify(a);
        a = a.replace(/\\/g, "\\\\").replace(/"/g, '\\"');
        return c ? a : _.sprintf('"%s"', a)
    };
    a.round = function (a, c) {
        return Math.round(a * Math.pow(10, c)) / Math.pow(10, c)
    }
});
(function (a) {
    var d, b, c, f, k, h, m, l, u, y, s = 0,
        i = {}, j = [],
        n = 0,
        g = {}, t = [],
        C = null,
        x = new Image,
        F = /\.(jpg|gif|png|bmp|jpeg)(.*)?$/i,
        G = /[^\.]\.(swf)\s*$/i,
        e, p = 1,
        z = 0,
        w = "",
        v, q, r = !1,
        A = a.extend(a("<div/>")[0], {
            prop: 0
        }),
        B = a.browser.msie && 7 > a.browser.version && !window.XMLHttpRequest,
        H = function () {
            b.hide();
            x.onerror = x.onload = null;
            C && C.abort();
            d.empty()
        }, I = function () {
            !1 === i.onError(j, s, i) ? (b.hide(), r = !1) : (i.titleShow = !1, i.width = "auto", i.height = "auto", d.html('<p id="fancybox-error">The requested content cannot be loaded.<br />Please try again later.</p>'),
                E())
        }, D = function () {
            var c = j[s],
                e, f, g, k, l, m;
            H();
            i = a.extend({}, a.fn.fancybox.defaults, "undefined" == typeof a(c).data("fancybox") ? i : a(c).data("fancybox"));
            m = i.onStart(j, s, i);
            if (!1 === m) r = !1;
            else {
                "object" == typeof m && (i = a.extend(i, m));
                g = i.title || (c.nodeName ? a(c).attr("title") : c.title) || "";
                if (c.nodeName && !i.orig) i.orig = a(c).children("img:first").length ? a(c).children("img:first") : a(c);
                "" === g && i.orig && i.titleFromAlt && (g = i.orig.attr("alt"));
                e = i.href || (c.nodeName ? a(c).attr("href") : c.href) || null;
                if (/^(?:javascript)/i.test(e) ||
                    "#" == e) e = null;
                if (i.type) {
                    if (f = i.type, !e) e = i.content
                } else i.content ? f = "html" : e && (f = e.match(F) ? "image" : e.match(G) ? "swf" : a(c).hasClass("iframe") ? "iframe" : 0 === e.indexOf("#") ? "inline" : "ajax"); if (f) {
                    "inline" == f && (c = e.substr(e.indexOf("#")), f = 0 < a(c).length ? "inline" : "ajax");
                    i.type = f;
                    i.href = e;
                    i.title = g;
                    if (i.autoDimensions && "iframe" !== i.type && "swf" !== i.type) i.width = "auto", i.height = "auto";
                    if (i.modal) i.overlayShow = !0, i.hideOnOverlayClick = !1, i.hideOnContentClick = !1, i.enableEscapeButton = !1, i.showCloseButton = !1;
                    i.padding = parseInt(i.padding, 10);
                    i.margin = parseInt(i.margin, 10);
                    d.css("padding", i.padding + i.margin);
                    a(".fancybox-inline-tmp").unbind("fancybox-cancel").bind("fancybox-change", function () {
                        a(this).replaceWith(h.children())
                    });
                    switch (f) {
                    case "html":
                        d.html(i.content);
                        E();
                        break;
                    case "inline":
                        if (!0 === a(c).parent().is("#fancybox-content")) {
                            r = !1;
                            break
                        }
                        a('<div class="fancybox-inline-tmp" />').hide().insertBefore(a(c)).bind("fancybox-cleanup", function () {
                            a(this).replaceWith(h.children())
                        }).bind("fancybox-cancel",
                            function () {
                                a(this).replaceWith(d.children())
                            });
                        a(c).appendTo(d);
                        E();
                        break;
                    case "image":
                        r = !1;
                        a.fancybox.showActivity();
                        x = new Image;
                        x.onerror = function () {
                            I()
                        };
                        x.onload = function () {
                            r = !0;
                            x.onerror = x.onload = null;
                            i.width = x.width;
                            i.height = x.height;
                            a("<img />").attr({
                                id: "fancybox-img",
                                src: x.src,
                                alt: i.title
                            }).appendTo(d);
                            J()
                        };
                        x.src = e;
                        break;
                    case "swf":
                        k = '<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="' + i.width + '" height="' + i.height + '"><param name="movie" value="' + e + '"></param>';
                        l = "";
                        a.each(i.swf,
                            function (a, b) {
                                k += '<param name="' + a + '" value="' + b + '"></param>';
                                l += " " + a + '="' + b + '"'
                            });
                        k += '<embed src="' + e + '" type="application/x-shockwave-flash" width="' + i.width + '" height="' + i.height + '"' + l + "></embed></object>";
                        d.html(k);
                        E();
                        break;
                    case "ajax":
                        r = !1;
                        a.fancybox.showActivity();
                        i.ajax.win = i.ajax.success;
                        C = a.ajax(a.extend({}, i.ajax, {
                            url: e,
                            data: i.ajax.data || {},
                            error: function (a) {
                                0 < a.status && I()
                            },
                            success: function (a, c, f) {
                                if (200 == f.status) {
                                    if ("function" == typeof i.ajax.win) {
                                        m = i.ajax.win(e, a, c, f);
                                        if (!1 === m) {
                                            b.hide();
                                            return
                                        }
                                        if ("string" == typeof m || "object" == typeof m) a = m
                                    }
                                    d.html(a);
                                    E()
                                }
                            }
                        }));
                        break;
                    case "iframe":
                        J()
                    }
                } else I()
            }
        }, E = function () {
            d.width(i.width);
            d.height(i.height);
            if ("auto" == i.width) i.width = d.width();
            if ("auto" == i.height) i.height = d.height();
            J()
        }, J = function () {
            var e, O;
            b.hide();
            if (f.is(":visible") && !1 === g.onCleanup(t, n, g)) a.event.trigger("fancybox-cancel"), r = !1;
            else {
                r = !0;
                a(h.add(c)).unbind();
                a(window).unbind("resize.fb scroll.fb");
                a(document).unbind("keydown.fb");
                f.is(":visible") && "outside" !== g.titlePosition &&
                    f.css("height", f.height());
                t = j;
                n = s;
                g = i;
                if (g.overlayShow) {
                    if (c.css({
                        "background-color": g.overlayColor,
                        opacity: g.overlayOpacity,
                        cursor: g.hideOnOverlayClick ? "pointer" : "auto",
                        height: a(document).height()
                    }), !c.is(":visible")) {
                        if (B) a("select:not(#fancybox-tmp select)").filter(function () {
                            return "hidden" !== this.style.visibility
                        }).css({
                            visibility: "hidden"
                        }).one("fancybox-cleanup", function () {
                            this.style.visibility = "inherit"
                        });
                        c.show()
                    }
                } else c.hide();
                h.get(0).scrollTop = 0;
                h.get(0).scrollLeft = 0;
                q = P();
                w = g.title ||
                    "";
                z = 0;
                l.empty().removeAttr("style").removeClass();
                if (!1 !== g.titleShow && (w = a.isFunction(g.titleFormat) ? g.titleFormat(w, t, n, g) : w && w.length ? "float" == g.titlePosition ? '<table id="fancybox-title-float-wrap" cellpadding="0" cellspacing="0"><tr><td id="fancybox-title-float-left"></td><td id="fancybox-title-float-main">' + w + '</td><td id="fancybox-title-float-right"></td></tr></table>' : '<div id="fancybox-title-' + g.titlePosition + '">' + w + "</div>" : !1) && "" !== w) switch (l.addClass("fancybox-title-" + g.titlePosition).html(w).appendTo("body").show(),
                    g.titlePosition) {
                case "inside":
                    l.css({
                        width: q.width - 2 * g.padding,
                        marginLeft: g.padding,
                        marginRight: g.padding
                    });
                    z = l.outerHeight(!0);
                    l.appendTo(k);
                    q.height += z;
                    break;
                case "over":
                    l.css({
                        marginLeft: g.padding,
                        width: q.width - 2 * g.padding,
                        bottom: g.padding
                    }).appendTo(k);
                    break;
                case "float":
                    l.css("left", -1 * parseInt((l.width() - q.width - 40) / 2, 10)).appendTo(f);
                    break;
                default:
                    l.css({
                        width: q.width - 2 * g.padding,
                        paddingLeft: g.padding,
                        paddingRight: g.padding
                    }).appendTo(f)
                }
                l.hide();
                if (f.is(":visible")) a(m.add(u).add(y)).hide(),
                e = f.position(), v = {
                    top: e.top,
                    left: e.left,
                    width: f.width(),
                    height: f.height()
                }, O = v.width == q.width && v.height == q.height, h.fadeTo(g.changeFade, 0.3, function () {
                    var b = function () {
                        h.html(d.contents()).fadeTo(g.changeFade, 1, K)
                    };
                    a.event.trigger("fancybox-change");
                    h.empty().removeAttr("filter").css({
                        "border-width": g.padding,
                        width: q.width - 2 * g.padding,
                        height: "image" == g.type || "swf" == g.type || "iframe" == g.type ? q.height - z - 2 * g.padding : "auto"
                    });
                    O ? b() : (A.prop = 0, a(A).animate({
                        prop: 1
                    }, {
                        duration: g.changeSpeed,
                        easing: g.easingChange,
                        step: L,
                        complete: b
                    }))
                });
                else if (f.removeAttr("style"), h.css("border-width", g.padding), "elastic" == g.transitionIn) {
                    v = N();
                    h.html(d.contents());
                    f.show();
                    if (g.opacity) q.opacity = 0;
                    A.prop = 0;
                    a(A).animate({
                        prop: 1
                    }, {
                        duration: g.speedIn,
                        easing: g.easingIn,
                        step: L,
                        complete: K
                    })
                } else "inside" == g.titlePosition && 0 < z && l.show(), h.css({
                    width: q.width - 2 * g.padding,
                    height: "image" == g.type || "swf" == g.type || "iframe" == g.type ? q.height - z - 2 * g.padding : "auto"
                }).html(d.contents()), f.css(q).fadeIn("none" == g.transitionIn ? 0 : g.fadeIn, K)
            }
        },
        o = function () {
            (g.enableEscapeButton || g.enableKeyboardNav) && a(document).bind("keydown.fb", function (b) {
                if (27 == b.keyCode && g.enableEscapeButton) b.preventDefault(), a.fancybox.close();
                else if ((37 == b.keyCode || 39 == b.keyCode) && g.enableKeyboardNav && "INPUT" !== b.target.tagName && "TEXTAREA" !== b.target.tagName && "SELECT" !== b.target.tagName) b.preventDefault(), a.fancybox[37 == b.keyCode ? "prev" : "next"]()
            });
            g.showNavArrows ? ((g.cyclic && 1 < t.length || 0 !== n) && u.show(), (g.cyclic && 1 < t.length || n != t.length - 1) && y.show()) : (u.hide(),
                y.hide())
        }, K = function () {
            a.support.opacity || (h.get(0).style.removeAttribute("filter"), f.get(0).style.removeAttribute("filter"));
            f.css("height", "auto");
            "image" !== g.type && "swf" !== g.type && "iframe" !== g.type && h.css("height", "auto");
            w && w.length && l.show();
            g.showCloseButton && m.show();
            o();
            g.hideOnContentClick && h.bind("click", a.fancybox.close);
            g.hideOnOverlayClick && c.bind("click", a.fancybox.close);
            a(window).bind("resize.fb", a.fancybox.resize);
            g.centerOnScroll && a(window).bind("scroll.fb", a.fancybox.center);
            "iframe" ==
                g.type && a('<iframe id="fancybox-frame" name="fancybox-frame' + (new Date).getTime() + '" frameborder="0" hspace="0" ' + (a.browser.msie ? 'allowtransparency="true""' : "") + ' scrolling="' + i.scrolling + '" src="' + g.href + '"></iframe>').appendTo(h);
            f.show();
            r = !1;
            a.fancybox.center();
            g.onComplete(t, n, g);
            var b, d;
            if (t.length - 1 > n && (b = t[n + 1].href, "undefined" !== typeof b && b.match(F))) d = new Image, d.src = b;
            if (0 < n && (b = t[n - 1].href, "undefined" !== typeof b && b.match(F))) d = new Image, d.src = b
        }, L = function (a) {
            var b = {
                width: parseInt(v.width +
                    (q.width - v.width) * a, 10),
                height: parseInt(v.height + (q.height - v.height) * a, 10),
                top: parseInt(v.top + (q.top - v.top) * a, 10),
                left: parseInt(v.left + (q.left - v.left) * a, 10)
            };
            if ("undefined" !== typeof q.opacity) b.opacity = 0.5 > a ? 0.5 : a;
            f.css(b);
            h.css({
                width: b.width - 2 * g.padding,
                height: b.height - z * a - 2 * g.padding
            })
        }, M = function () {
            return [a(window).width() - 2 * g.margin, a(window).height() - 2 * g.margin, a(document).scrollLeft() + g.margin, a(document).scrollTop() + g.margin]
        }, P = function () {
            var a = M(),
                b = {}, c = g.autoScale,
                d = 2 * g.padding;
            b.width = -1 < g.width.toString().indexOf("%") ? parseInt(a[0] * parseFloat(g.width) / 100, 10) : g.width + d;
            b.height = -1 < g.height.toString().indexOf("%") ? parseInt(a[1] * parseFloat(g.height) / 100, 10) : g.height + d;
            if (c && (b.width > a[0] || b.height > a[1]))
                if ("image" == i.type || "swf" == i.type) {
                    c = g.width / g.height;
                    if (b.width > a[0]) b.width = a[0], b.height = parseInt((b.width - d) / c + d, 10);
                    if (b.height > a[1]) b.height = a[1], b.width = parseInt((b.height - d) * c + d, 10)
                } else b.width = Math.min(b.width, a[0]), b.height = Math.min(b.height, a[1]);
            b.top = parseInt(Math.max(a[3] -
                20, a[3] + 0.5 * (a[1] - b.height - 40)), 10);
            b.left = parseInt(Math.max(a[2] - 20, a[2] + 0.5 * (a[0] - b.width - 40)), 10);
            return b
        }, N = function () {
            var b = i.orig ? a(i.orig) : !1,
                c = {};
            b && b.length ? (c = b.offset(), c.top += parseInt(b.css("paddingTop"), 10) || 0, c.left += parseInt(b.css("paddingLeft"), 10) || 0, c.top += parseInt(b.css("border-top-width"), 10) || 0, c.left += parseInt(b.css("border-left-width"), 10) || 0, c.width = b.width(), c.height = b.height(), c = {
                width: c.width + 2 * g.padding,
                height: c.height + 2 * g.padding,
                top: c.top - g.padding - 20,
                left: c.left - g.padding - 20
            }) : (b = M(), c = {
                width: 2 * g.padding,
                height: 2 * g.padding,
                top: parseInt(b[3] + 0.5 * b[1], 10),
                left: parseInt(b[2] + 0.5 * b[0], 10)
            });
            return c
        }, Q = function () {
            b.is(":visible") ? (a("div", b).css("top", -40 * p + "px"), p = (p + 1) % 12) : clearInterval(e)
        };
    a.fn.fancybox = function (b) {
        if (!a(this).length) return this;
        a(this).data("fancybox", a.extend({}, b, a.metadata ? a(this).metadata() : {})).unbind("click.fb").bind("click.fb", function (b) {
            b.preventDefault();
            r || (r = !0, a(this).blur(), j = [], s = 0, b = a(this).attr("rel") || "", !b || "" == b || "nofollow" === b ?
                j.push(this) : (j = a("a[rel=" + b + "], area[rel=" + b + "]"), s = j.index(this)), D())
        });
        return this
    };
    a.fancybox = function (b, c) {
        var d;
        if (!r) {
            r = !0;
            d = "undefined" !== typeof c ? c : {};
            j = [];
            s = parseInt(d.index, 10) || 0;
            if (a.isArray(b)) {
                for (var e = 0, f = b.length; e < f; e++) "object" == typeof b[e] ? a(b[e]).data("fancybox", a.extend({}, d, b[e])) : b[e] = a({}).data("fancybox", a.extend({
                    content: b[e]
                }, d));
                j = jQuery.merge(j, b)
            } else "object" == typeof b ? a(b).data("fancybox", a.extend({}, d, b)) : b = a({}).data("fancybox", a.extend({
                content: b
            }, d)), j.push(b);
            if (s > j.length || 0 > s) s = 0;
            D()
        }
    };
    a.fancybox.showActivity = function () {
        clearInterval(e);
        b.show();
        e = setInterval(Q, 66)
    };
    a.fancybox.hideActivity = function () {
        b.hide()
    };
    a.fancybox.next = function () {
        return a.fancybox.pos(n + 1)
    };
    a.fancybox.prev = function () {
        return a.fancybox.pos(n - 1)
    };
    a.fancybox.pos = function (a) {
        r || (a = parseInt(a), j = t, -1 < a && a < t.length ? (s = a, D()) : g.cyclic && 1 < t.length && (s = a >= t.length ? 0 : t.length - 1, D()))
    };
    a.fancybox.cancel = function () {
        r || (r = !0, a.event.trigger("fancybox-cancel"), H(), i.onCancel(j, s, i), r = !1)
    };
    a.fancybox.close = function () {
        function b() {
            c.fadeOut("fast");
            l.empty().hide();
            f.hide();
            a.event.trigger("fancybox-cleanup");
            h.empty();
            g.onClosed(t, n, g);
            t = i = [];
            n = s = 0;
            g = i = {};
            r = !1
        }
        if (!r && !f.is(":hidden"))
            if (r = !0, g && !1 === g.onCleanup(t, n, g)) r = !1;
            else if (H(), a(m.add(u).add(y)).hide(), a(h.add(c)).unbind(), a(window).unbind("resize.fb scroll.fb"), a(document).unbind("keydown.fb"), h.find("iframe").attr("src", B && /^https/i.test(window.location.href || "") ? "javascript:void(false)" : "about:blank"), "inside" !== g.titlePosition &&
            l.empty(), f.stop(), "elastic" == g.transitionOut) {
            v = N();
            var d = f.position();
            q = {
                top: d.top,
                left: d.left,
                width: f.width(),
                height: f.height()
            };
            if (g.opacity) q.opacity = 1;
            l.empty().hide();
            A.prop = 1;
            a(A).animate({
                prop: 0
            }, {
                duration: g.speedOut,
                easing: g.easingOut,
                step: L,
                complete: b
            })
        } else f.fadeOut("none" == g.transitionOut ? 0 : g.speedOut, b)
    };
    a.fancybox.resize = function () {
        c.is(":visible") && c.css("height", a(document).height());
        a.fancybox.center(!0)
    };
    a.fancybox.center = function (a) {
        var b, c;
        if (!r && (c = !0 === a ? 1 : 0, b = M(), c || !(f.width() >
            b[0] || f.height() > b[1]))) f.stop().animate({
            top: parseInt(Math.max(b[3] - 20, b[3] + 0.5 * (b[1] - h.height() - 40) - g.padding)),
            left: parseInt(Math.max(b[2] - 20, b[2] + 0.5 * (b[0] - h.width() - 40) - g.padding))
        }, "number" == typeof a ? a : 200)
    };
    a.fancybox.init = function () {
        a("#fancybox-wrap").length || (a("body").append(d = a('<div id="fancybox-tmp"></div>'), b = a('<div id="fancybox-loading"><div></div></div>'), c = a('<div id="fancybox-overlay"></div>'), f = a('<div id="fancybox-wrap"></div>')), k = a('<div id="fancybox-outer"></div>').append('<div class="fancybox-bg" id="fancybox-bg-n"></div><div class="fancybox-bg" id="fancybox-bg-ne"></div><div class="fancybox-bg" id="fancybox-bg-e"></div><div class="fancybox-bg" id="fancybox-bg-se"></div><div class="fancybox-bg" id="fancybox-bg-s"></div><div class="fancybox-bg" id="fancybox-bg-sw"></div><div class="fancybox-bg" id="fancybox-bg-w"></div><div class="fancybox-bg" id="fancybox-bg-nw"></div>').appendTo(f),
            k.append(h = a('<div id="fancybox-content"></div>'), m = a('<a id="fancybox-close"></a>'), l = a('<div id="fancybox-title"></div>'), u = a('<a href="javascript:;" id="fancybox-left"><span class="fancy-ico" id="fancybox-left-ico"></span></a>'), y = a('<a href="javascript:;" id="fancybox-right"><span class="fancy-ico" id="fancybox-right-ico"></span></a>')), m.click(a.fancybox.close), b.click(a.fancybox.cancel), u.click(function (b) {
                b.preventDefault();
                a.fancybox.prev()
            }), y.click(function (b) {
                b.preventDefault();
                a.fancybox.next()
            }),
            a.fn.mousewheel && f.bind("mousewheel.fb", function (b, c) {
                b.preventDefault();
                a.fancybox[0 < c ? "prev" : "next"]()
            }), a.support.opacity || f.addClass("fancybox-ie"), B && (b.addClass("fancybox-ie6"), f.addClass("fancybox-ie6"), a('<iframe id="fancybox-hide-sel-frame" src="' + (/^https/i.test(window.location.href || "") ? "javascript:void(false)" : "about:blank") + '" scrolling="no" border="0" frameborder="0" tabindex="-1"></iframe>').prependTo(k)))
    };
    a.fn.fancybox.defaults = {
        padding: 10,
        margin: 40,
        opacity: !1,
        modal: !1,
        cyclic: !1,
        scrolling: "auto",
        width: 560,
        height: 340,
        autoScale: !0,
        autoDimensions: !0,
        centerOnScroll: !1,
        ajax: {},
        swf: {
            wmode: "transparent"
        },
        hideOnOverlayClick: !0,
        hideOnContentClick: !1,
        overlayShow: !0,
        overlayOpacity: 0.7,
        overlayColor: "#777",
        titleShow: !0,
        titlePosition: "float",
        titleFormat: null,
        titleFromAlt: !1,
        transitionIn: "fade",
        transitionOut: "fade",
        speedIn: 300,
        speedOut: 300,
        changeSpeed: 300,
        changeFade: "fast",
        easingIn: "swing",
        easingOut: "swing",
        showCloseButton: !0,
        showNavArrows: !0,
        enableEscapeButton: !0,
        enableKeyboardNav: !0,
        onStart: function () {},
        onCancel: function () {},
        onComplete: function () {},
        onCleanup: function () {},
        onClosed: function () {},
        onError: function () {}
    };
    a(document).ready(function () {
        a.fancybox.init()
    })
})(jQuery);