var swfobject=function(){function c(){if(!u){try{var a=f.getElementsByTagName("body")[0].appendChild(f.createElement("span"));a.parentNode.removeChild(a)}catch(b){return}u=!0;for(var a=z.length,d=0;d<a;d++)z[d]()}}function h(a){u?a():z[z.length]=a}function j(a){if(typeof m.addEventListener!=l)m.addEventListener("load",a,!1);else if(typeof f.addEventListener!=l)f.addEventListener("load",a,!1);else if(typeof m.attachEvent!=l)T(m,"onload",a);else if("function"==typeof m.onload){var b=m.onload;m.onload=
function(){b();a()}}else m.onload=a}function r(){var a=f.getElementsByTagName("body")[0],b=f.createElement(s);b.setAttribute("type",A);var d=a.appendChild(b);if(d){var g=0;(function(){if(typeof d.GetVariable!=l){var i=d.GetVariable("$version");if(i)i=i.split(" ")[1].split(","),e.pv=[parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10)]}else if(10>g){g++;setTimeout(arguments.callee,10);return}a.removeChild(b);d=null;p()})()}else p()}function p(){var a=q.length;if(0<a)for(var b=0;b<a;b++){var d=q[b].id,
g=q[b].callbackFn,i={success:!1,id:d};if(0<e.pv[0]){var f=n(d);if(f)if(B(q[b].swfVersion)&&!(e.wk&&312>e.wk)){if(v(d,!0),g)i.success=!0,i.ref=F(d),g(i)}else if(q[b].expressInstall&&G()){i={};i.data=q[b].expressInstall;i.width=f.getAttribute("width")||"0";i.height=f.getAttribute("height")||"0";if(f.getAttribute("class"))i.styleclass=f.getAttribute("class");if(f.getAttribute("align"))i.align=f.getAttribute("align");for(var k={},f=f.getElementsByTagName("param"),j=f.length,c=0;c<j;c++)"movie"!=f[c].getAttribute("name").toLowerCase()&&
(k[f[c].getAttribute("name")]=f[c].getAttribute("value"));H(i,k,d,g)}else w(f),g&&g(i)}else if(v(d,!0),g){if((d=F(d))&&typeof d.SetVariable!=l)i.success=!0,i.ref=d;g(i)}}}function F(a){var b=null;if((a=n(a))&&"OBJECT"==a.nodeName)typeof a.SetVariable!=l?b=a:(a=a.getElementsByTagName(s)[0])&&(b=a);return b}function G(){return!C&&B("6.0.65")&&(e.win||e.mac)&&!(e.wk&&312>e.wk)}function H(a,b,d,g){C=!0;I=g||null;M={success:!1,id:d};var i=n(d);if(i){"OBJECT"==i.nodeName?(y=J(i),D=null):(y=i,D=d);a.id=
N;if(typeof a.width==l||!/%$/.test(a.width)&&310>parseInt(a.width,10))a.width="310";if(typeof a.height==l||!/%$/.test(a.height)&&137>parseInt(a.height,10))a.height="137";f.title=f.title.slice(0,47)+" - Flash Player Installation";g=e.ie&&e.win?"ActiveX":"PlugIn";g="MMredirectURL="+m.location.toString().replace(/&/g,"%26")+"&MMplayerType="+g+"&MMdoctitle="+f.title;b.flashvars=typeof b.flashvars!=l?b.flashvars+("&"+g):g;if(e.ie&&e.win&&4!=i.readyState)g=f.createElement("div"),d+="SWFObjectNew",g.setAttribute("id",
d),i.parentNode.insertBefore(g,i),i.style.display="none",function(){4==i.readyState?i.parentNode.removeChild(i):setTimeout(arguments.callee,10)}();K(a,b,d)}}function w(a){if(e.ie&&e.win&&4!=a.readyState){var b=f.createElement("div");a.parentNode.insertBefore(b,a);b.parentNode.replaceChild(J(a),b);a.style.display="none";(function(){4==a.readyState?a.parentNode.removeChild(a):setTimeout(arguments.callee,10)})()}else a.parentNode.replaceChild(J(a),a)}function J(a){var b=f.createElement("div");if(e.win&&
e.ie)b.innerHTML=a.innerHTML;else if(a=a.getElementsByTagName(s)[0])if(a=a.childNodes)for(var d=a.length,g=0;g<d;g++)!(1==a[g].nodeType&&"PARAM"==a[g].nodeName)&&8!=a[g].nodeType&&b.appendChild(a[g].cloneNode(!0));return b}function K(a,b,d){var g,i=n(d);if(e.wk&&312>e.wk)return g;if(i){if(typeof a.id==l)a.id=d;if(e.ie&&e.win){var c="",k;for(k in a)if(a[k]!=Object.prototype[k])"data"==k.toLowerCase()?b.movie=a[k]:"styleclass"==k.toLowerCase()?c+=' class="'+a[k]+'"':"classid"!=k.toLowerCase()&&(c+=
" "+k+'="'+a[k]+'"');k="";for(var j in b)b[j]!=Object.prototype[j]&&(k+='<param name="'+j+'" value="'+b[j]+'" />');i.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+c+">"+k+"</object>";E[E.length]=a.id;g=n(a.id)}else{j=f.createElement(s);j.setAttribute("type",A);for(var h in a)a[h]!=Object.prototype[h]&&("styleclass"==h.toLowerCase()?j.setAttribute("class",a[h]):"classid"!=h.toLowerCase()&&j.setAttribute(h,a[h]));for(c in b)b[c]!=Object.prototype[c]&&"movie"!=c.toLowerCase()&&
(a=j,k=c,h=b[c],d=f.createElement("param"),d.setAttribute("name",k),d.setAttribute("value",h),a.appendChild(d));i.parentNode.replaceChild(j,i);g=j}}return g}function O(a){var b=n(a);if(b&&"OBJECT"==b.nodeName)e.ie&&e.win?(b.style.display="none",function(){if(4==b.readyState){var d=n(a);if(d){for(var g in d)"function"==typeof d[g]&&(d[g]=null);d.parentNode.removeChild(d)}}else setTimeout(arguments.callee,10)}()):b.parentNode.removeChild(b)}function n(a){var b=null;try{b=f.getElementById(a)}catch(d){}return b}
function T(a,b,d){a.attachEvent(b,d);x[x.length]=[a,b,d]}function B(a){var b=e.pv,a=a.split(".");a[0]=parseInt(a[0],10);a[1]=parseInt(a[1],10)||0;a[2]=parseInt(a[2],10)||0;return b[0]>a[0]||b[0]==a[0]&&b[1]>a[1]||b[0]==a[0]&&b[1]==a[1]&&b[2]>=a[2]?!0:!1}function P(a,b,d,g){if(!e.ie||!e.mac){var i=f.getElementsByTagName("head")[0];if(i){d=d&&"string"==typeof d?d:"screen";g&&(L=o=null);if(!o||L!=d)g=f.createElement("style"),g.setAttribute("type","text/css"),g.setAttribute("media",d),o=i.appendChild(g),
e.ie&&e.win&&typeof f.styleSheets!=l&&0<f.styleSheets.length&&(o=f.styleSheets[f.styleSheets.length-1]),L=d;e.ie&&e.win?o&&typeof o.addRule==s&&o.addRule(a,b):o&&typeof f.createTextNode!=l&&o.appendChild(f.createTextNode(a+" {"+b+"}"))}}}function v(a,b){if(Q){var d=b?"visible":"hidden";u&&n(a)?n(a).style.visibility=d:P("#"+a,"visibility:"+d)}}function R(a){return null!=/[\\\"<>\.;]/.exec(a)&&typeof encodeURIComponent!=l?encodeURIComponent(a):a}var l="undefined",s="object",A="application/x-shockwave-flash",
N="SWFObjectExprInst",m=window,f=document,t=navigator,S=!1,z=[function(){S?r():p()}],q=[],E=[],x=[],y,D,I,M,u=!1,C=!1,o,L,Q=!0,e=function(){var a=typeof f.getElementById!=l&&typeof f.getElementsByTagName!=l&&typeof f.createElement!=l,b=t.userAgent.toLowerCase(),d=t.platform.toLowerCase(),g=d?/win/.test(d):/win/.test(b),d=d?/mac/.test(d):/mac/.test(b),b=/webkit/.test(b)?parseFloat(b.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,i=!+"\u000b1",e=[0,0,0],c=null;if(typeof t.plugins!=l&&typeof t.plugins["Shockwave Flash"]==
s){if((c=t.plugins["Shockwave Flash"].description)&&!(typeof t.mimeTypes!=l&&t.mimeTypes[A]&&!t.mimeTypes[A].enabledPlugin))S=!0,i=!1,c=c.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),e[0]=parseInt(c.replace(/^(.*)\..*$/,"$1"),10),e[1]=parseInt(c.replace(/^.*\.(.*)\s.*$/,"$1"),10),e[2]=/[a-zA-Z]/.test(c)?parseInt(c.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}else if(typeof m.ActiveXObject!=l)try{var j=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(j&&(c=j.GetVariable("$version")))i=!0,c=c.split(" ")[1].split(","),
e=[parseInt(c[0],10),parseInt(c[1],10),parseInt(c[2],10)]}catch(h){}return{w3:a,pv:e,wk:b,ie:i,win:g,mac:d}}();(function(){e.w3&&((typeof f.readyState!=l&&"complete"==f.readyState||typeof f.readyState==l&&(f.getElementsByTagName("body")[0]||f.body))&&c(),u||(typeof f.addEventListener!=l&&f.addEventListener("DOMContentLoaded",c,!1),e.ie&&e.win&&(f.attachEvent("onreadystatechange",function(){"complete"==f.readyState&&(f.detachEvent("onreadystatechange",arguments.callee),c())}),m==top&&function(){if(!u){try{f.documentElement.doScroll("left")}catch(a){setTimeout(arguments.callee,
0);return}c()}}()),e.wk&&function(){u||(/loaded|complete/.test(f.readyState)?c():setTimeout(arguments.callee,0))}(),j(c)))})();(function(){e.ie&&e.win&&window.attachEvent("onunload",function(){for(var a=x.length,b=0;b<a;b++)x[b][0].detachEvent(x[b][1],x[b][2]);a=E.length;for(b=0;b<a;b++)O(E[b]);for(var d in e)e[d]=null;e=null;for(var g in swfobject)swfobject[g]=null;swfobject=null})})();return{registerObject:function(a,b,d,g){if(e.w3&&a&&b){var c={};c.id=a;c.swfVersion=b;c.expressInstall=d;c.callbackFn=
g;q[q.length]=c;v(a,!1)}else g&&g({success:!1,id:a})},getObjectById:function(a){if(e.w3)return F(a)},embedSWF:function(a,b,d,c,f,j,k,r,m,p){var n={success:!1,id:b};e.w3&&!(e.wk&&312>e.wk)&&a&&b&&d&&c&&f?(v(b,!1),h(function(){d+="";c+="";var e={};if(m&&typeof m===s)for(var h in m)e[h]=m[h];e.data=a;e.width=d;e.height=c;h={};if(r&&typeof r===s)for(var o in r)h[o]=r[o];if(k&&typeof k===s)for(var q in k)h.flashvars=typeof h.flashvars!=l?h.flashvars+("&"+q+"="+k[q]):q+"="+k[q];if(B(f))o=K(e,h,b),e.id==
b&&v(b,!0),n.success=!0,n.ref=o;else{if(j&&G()){e.data=j;H(e,h,b,p);return}v(b,!0)}p&&p(n)})):p&&p(n)},switchOffAutoHideShow:function(){Q=!1},ua:e,getFlashPlayerVersion:function(){return{major:e.pv[0],minor:e.pv[1],release:e.pv[2]}},hasFlashPlayerVersion:B,createSWF:function(a,b,d){if(e.w3)return K(a,b,d)},showExpressInstall:function(a,b,d,c){e.w3&&G()&&H(a,b,d,c)},removeSWF:function(a){e.w3&&O(a)},createCSS:function(a,b,d,c){e.w3&&P(a,b,d,c)},addDomLoadEvent:h,addLoadEvent:j,getQueryParamValue:function(a){var b=
f.location.search||f.location.hash;if(b){/\?/.test(b)&&(b=b.split("?")[1]);if(null==a)return R(b);for(var b=b.split("&"),d=0;d<b.length;d++)if(b[d].substring(0,b[d].indexOf("="))==a)return R(b[d].substring(b[d].indexOf("=")+1))}return""},expressInstallCallback:function(){if(C){var a=n(N);if(a&&y){a.parentNode.replaceChild(y,a);if(D&&(v(D,!0),e.ie&&e.win))y.style.display="block";I&&I(M)}C=!1}}}}();
_.namespace("Backbone.widgets",function(){return{ModalWindow:Backbone.Widget.extend({className:"backbone_modal_window",templates:{base:'<div class="window_wrap"><div class="close"><img src="//cdn.mxpnl.com/cache/9dbad713be1097e6ad6dcb6b448bfdd7/images/backbone_widgets/icon_x.png" /></div><div class="window"><div class="content"></div></div></div>'},events:{"click .close":"handle_close",click:"clickout"},initialize:function(){this.render_base_template();this.hide();this.$el.appendTo(this.options.wrapper||
"body");this.content=this.$(".content");_.isNumber(this.options.padding)?this.$(".window").css("padding",this.options.padding):this.options.padding=14;this.options.wrapper&&this.$el.css("position","absolute");var c,h;if(this.options.width)c="width",h=this.options.width;else if(this.options.min_width)c="min-width",h=this.options.min_width;else if(this.options.max_width)c="max-width",h=this.options.max_width;c&&this.$(".window_wrap").css(c,h+2*this.options.padding);this.options.widget&&this.set_widget(this.options.widget);
if(this.options.disable_close||this.options.hide_close)this.$el.addClass("close_disabled"),this.$(".close").hide();this.on_close(function(){this.widget&&this.widget.close();$(this.options.wrapper||window).off("resize.backbone_modal_widget")})},set_widget:function(c){this.widget&&this.widget.close();this.widget=c;this.content.empty().append(this.widget.el)},set_content:function(c){this.content.empty().append(c)},show:function(){this.$el.show();this.content.children().show();$(this.options.wrapper||
window).on("resize.backbone_model_widget",_.bind(this.resize,this)).resize();this.trigger("show")},hide:function(){this.$el.hide();$(this.options.wrapper||window).off("resize.backbone_modal_widget");this.trigger("hide")},is_visible:function(){return this.$el.is(":visible")},handle_close:function(){if(!this.options.disable_close&&(this.hide(),this.options.on_close))this.options.on_close()},clickout:function(c){c.target===this.el&&this.handle_close()},resize:function(){var c=$(this.options.wrapper||
window).width(),h=$(this.options.wrapper||window).height(),j=this.$(".window_wrap"),r=j.outerWidth(),p=j.outerHeight();j.css({top:this.options.top||h/2-p/2,left:c/2-r/2})}})}});
_.namespace("Backbone.widgets",function(){var c=0,h={};window.onYouTubePlayerReady=function(c){_.has(h,c)&&(h[c](),delete h[c]);if(_.has(h,c+"rebind"))h[c+"rebind"]()};return{YouTubeView:Backbone.Widget.extend({api_url:"//www.youtube.com/v/%s?enablejsapi=1&version=3&playerapiid=%s",className:"backbone_youtube_view",templates:{base:"<div class='cover'><div class='play'></div><img></div><div id='<%= d.yt_id %>'></div>"},events:{"click .cover":"play"},initialize:function(){this.yt_id=_.sprintf("youtube_embed_%d",
c++);this.$el.addClass(this.className);this.render();this.load(this.options.video_id,this.options.cover_img_url,this.options.autoplay)},render:function(){this.render_base_template({yt_id:this.yt_id});this.cover=this.$(".cover");this.cover_img=this.$(".cover img");this.$el.css({position:"relative"});this.detect_flash()},detect_flash:function(){if(!swfobject.hasFlashPlayerVersion("8"))this.mw=new Backbone.widgets.ModalWindow({wrapper:this.el,width:400,disable_close:!0}),this.mw.set_content("We have detected that you do not have Flash Player installed.  Please visit <a href='http://get.adobe.com/flashplayer/'>Adobe</a> to download it now."),
this.mw.show()},load_api:function(c){var r={id:this.yt_id};if(!this.loading_api&&$("#"+this.yt_id).length)this.loading_api=!0,swfobject.embedSWF(_.sprintf(this.api_url,this.video_id||"PjmAKr_5VRE",this.yt_id),this.yt_id,"100%","100%","8","/site_media/plugins/swfobject/expressInstall.swf",{autohide:1,controls:2,modestbranding:1,rel:0,showinfo:0},{allowScriptAccess:"always",allowfullscreen:!0,wmode:"transparent"},r),h[this.yt_id]=_.bind(this.api_loaded,this,c),h[this.yt_id+"rebind"]=_.bind(this.player_bindings,
this)},api_loaded:function(c){this.api=document.getElementById(this.yt_id);this.video_id&&this.load(this.video_id,this.cover_img_url,c||this.autoplay)},check_api:function(){try{return this.api.getPlayerState(),!0}catch(c){return!1}},player_bindings:function(){window[this.yt_id+"_state_change"]=_.bind(function(c){switch(c){case 0:this.trigger("state:ended");this.stop_progress_tracking();break;case 1:this.trigger("state:playing");this.start_progress_tracking();break;case 2:this.trigger("state:paused");
this.stop_progress_tracking();break;case 3:this.trigger("state:buffering")}},this);this.api.addEventListener("onStateChange",this.yt_id+"_state_change")},start_progress_tracking:function(){this.time_tracking_id=window.setInterval(_.bind(function(){try{this.trigger("progress",this.api.getCurrentTime()/this.api.getDuration())}catch(c){this.stop_progress_tracking()}},this),1E3)},stop_progress_tracking:function(){if(this.time_tracking_id)window.clearInterval(this.time_tracking_id),this.time_tracking_id=
null},load:function(c,h,p){this.video_id=c;this.cover_img_url=h||void 0;this.autoplay=p;this.cover_img_url?(this.cover.show(),this.cover_img.attr("src",this.cover_img_url)):this.cover.hide();this.mw&&this.mw.resize();if(!this.check_api())return this.load_api();this.api.cueVideoById(this.video_id);this.api.setPlaybackQuality("hd720");this.autoplay&&this.play()},play:function(){if(!this.check_api())return this.load_api(!0);window.setTimeout(_.bind(function(){this.$el.height(9*this.$el.width()/16)},
this),200);this.cover.hide();this.video_id?this.api.loadVideoById(this.video_id,0,"hd720"):this.api.playVideo()},restart:function(){if(!this.check_api())return this.load_api(!0);this.api.seekTo(0);this.play()}})}});
_.namespace("mp.report",function(c){var h=Backbone.TemplateView.extend({className:"tutorial learn_video",templates:{base:'<div class="block"><div class="video"></div><h3><%= d.name %></h3><p><%= d.description %></p></div>'},default_options:{in_modal:!1,tab:null,report_style:"d2",video_id:null,video_thumb_url:null,tutorial_name:null,tutorial_description:null,init_track_shown:!0},initialize:function(){this.options=_.extend({},this.default_options,c.TutorialVideoManager.options,this.options);this.$el.addClass(this.className);
this.options.in_modal?this.options.init_track_shown&&this.track_shown():this.$el.addClass(this.options.report_style);this.render_base_template({name:this.options.tutorial_name,description:this.options.tutorial_description});this.render_player()},track_shown:function(){mixpanel.track("Tutorial Shown",{tab:this.options.tab})},render_player:function(){this.player=new Backbone.widgets.YouTubeView({el:this.$(".video"),video_id:this.options.video_id,cover_img_url:this.options.video_thumb_url});var c=!1,
h={75:!1,50:!1,25:!1};this.player.on("state:playing",function(){c||(mixpanel.track("Tutorial Video Started",{tab:this.options.tab}),c=!0)});this.player.on("state:ended",function(){mixpanel.track("Tutorial Video Finished",{tab:this.options.tab})});this.player.on("progress",_.bind(function(c){var j=null;_.any(h,function(r,w){w=Number(w);if(!r&&100*c>w)return j=w,h[w]=!0});j&&mixpanel.track(_.sprintf("Tutorial Video Progress (%f%%)",j),{tab:this.options.tab})},this))},restart:function(){this.player.restart()}}),
j=Backbone.View.extend({default_options:{check_flags:[],set_flag:null},setup:function(c){this.options=_.extend({},this.default_options,c);this.options.el&&(this.setElement(this.options.el),delete this.options.el)},show:function(){this.tutorial=new h({el:this.el})},check_flags:function(){return _.any(this.options.check_flags,function(c){return _.has(mp.report.globals.flags,c)})},create_modal:function(){if(!this.modal)this.modal=new Backbone.widgets.ModalWindow({width:850,widget:new h(_.extend(this.options,
{in_modal:!0})),on_close:_.bind(function(){this.modal.hide();this.message&&this.message.close();mixpanel.track("Tutorial Modal Closed",{tab:this.options.tab});this.options.set_flag&&mp.utility.set_flag(this.options.set_flag)},this)})},maybe_show_message:function(){var c=mp.report.globals.is_engage_resource?mp.report.globals.has_integrated_engage:mp.report.globals.has_integrated_arb;!this.check_flags()&&c&&this.show_message()},show_message:function(){this.create_modal();mixpanel.track("Tutorial Banner Shown",
{tab:this.options.tab});if(!this.message)this.message=new Backbone.widgets.ReportMessage({closable:!0,type:"video",title:_.sprintf("Watch a tutorial to learn how to use %s",this.options.tutorial_name),content:"Mixpanel has a lot to offer and the fastest way our other customers have become data driven is by watching this tutorial. It's really short and can save you a lot of time.",button_text:"Watch Video",button_callback:_.bind(function(){mixpanel.track("Tutorial Modal Shown",{tab:this.options.tab});
this.modal.show()},this),close_callback:_.bind(function(){mixpanel.track("Tutorial Banner Closed",{tab:this.options.tab});mp.utility.set_flag(this.options.set_flag)},this)})},show_modal:function(){this.create_modal();this.modal.show();this.modal.widget.restart()}});j.setup=function(c){j.options=c};return{TutorialVideo:h,TutorialVideoManager:new j}});
